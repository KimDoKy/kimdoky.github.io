---
layout: post
section-type: post
title: Two Scoops of Django - chap4. 장고 앱 디자인의 기본
category: django
tags: [ 'django' ]
---

장고 앱 디자인으로 들어가기 전에 용어 정리를 한다.

- 장고 프로젝트 : 장고 웹 프레임워크를 기반으로 한 웹 애플리케이션을 지칭한다.
- 장고 앱 : 프로젝트의 한 기능을 표현하기 위해 디자인된 작은 라이브러리를 지칭한다. 장고 프로젝트는 다수의 장고 앱으로 구성되어 있다. 앱 중 일부는 프로젝트 내부적으로 한 번만 이용되고 재사용되지 않기도 한다. 또는 때때로 외부 장고 패키지를 지칭하기도 한다.
- INSTALLED_APPS : 프로젝트에서 이용하려고 INSTALLED_APPS 세팅에 설정한 장고 앱들을 지칭한다.
- 서드 파티 장고 패키지 : 파이썬 패키지 도구들에 의해 패키지화된, 재사용 가능한 플러그인 형태로 이용 가능한 장고 앱을 지칭한다.

![]({{site.url}}/img/post/django/two_scoops/4.1.png)
> 장고 프로젝트는 일종의 냉장고 같은 것이다.

![]({{site.url}}/img/post/django/two_scoops/4.2.png)
> 앱은 냉장고 안의 냉장 용기이다.  
패키지는 상점에서 앱에 설치되기를 기다리고 있는 원재료들이다.

## 4.1 장고 앱 디자인의 황금률

"좋은 장고 앱을 정의하는 것은 유닉스 철학을 따른다. '한번에 한 가지 일을 하고 그 한 가지 일을 매우 충실히 하는 프로그램을 짜는 것이다.'"  

**각 앱이 그 앱의 주어진 임무에만 집중할 수 있어야 한다.**

### 4.1.1 실제 예를 통해 프로젝트 앱들을 정의해 보자
'Two Scoops'라는 가상의 아이스크림 상점을 위한 웹 어플리케이션을 만든다고 가정한다.  
이 상점의 장고 프로젝트는 twoscoops_project라고 하고, 장고 프로젝트 안의 앱들은 다음과 같이 구성 될 것이다.

- flavors app : 상점의 모든 아이스크림 종류가 기록되고 그 목록을 웹 사이트에 보여주는 앱
- blog app : 상점 Two Scoops의 공식 블로그
- events app : 상점의 행사 내용을 상점 웹 사이트에 보여주는 앱(ex:매주 일요일에 딸기 선디 특별 행사 등)

각각의 앱은 하나의 역할만 수행한다. 각 앱은 서로 연관 관계가 있다. events나 blog의 내용은 아이스크림 종류과 밀접한 관계가 있다. 하지만 모든 역할을 다 수행하는 하나의 앱을 구성하기 보단 세분화된 앱을 구성하는 것이 더 바람직하다.  

다음과 같이 앱들을 추가함으로 사이트를 확장할 수 있다.

- shop app : 온라인 주문을 통해 아이스크림을 판매하는 앱
- tickets app : 무제한 아이스크림 행사에 이용될 티켓 판매를 관리하는 앱

tickets 앱이 events와 분리되어 있다는 점을 주목해야 한다. 티켓을 팔기 위해 events 앱을 확장하는 대신 tickets 앱을 새로 생성했다. 대부분의 이벤트가 티켓을 필요로 하는 것이 아니며, 사이트가 성장함에 따라 이벤트 켈린더와 티켓 판매 사이에 복잡한 로직이 생겨날 수도 있기 때문이다.  

지금 가정을 기반으로 아이스크림랜디아 초기 콘셉트 맵이다. (이 tickets 앱이 아이스크림랜디아 테마파크용으로 이용하기 위한 것도 분리한 이유중 하나이다.)

![]({{site.url}}/img/post/django/two_scoops/4.3.png)

## 4.2 장고 앱 이름 정하기
창의적인 이름보다는 명료한 이름을 선호한다. 가능한 flavors, animals, blog, polls 같은 한 단어로 된 이름을 이용하자. 앱 이름이 명료하면 프로젝트 관리가 쉬워진다.  

좀 더 일반적인 규칙은 앱의 이름은 앱의 중심이 되는 모델 이름의 복수 형태가 되어야 한다. (blog같은건 예외)  

그리고 앱의 메인 모델 뿐만 아니라 URL의 주소도 같이 고려해야 한다.  
PEP-8 규약에 맞게 임포트될 수 있느 이름을 이용하도록 한다. 소문자로 구성괸 숫자, 대시(-), 마침표(.), 스페이스 그리고 특수 문자를 포함하지 않는 짧은 단어들을 이용함으로 PEP-8 규약을 맞출 수 있다. 밑줄(\_)을 이용하는 것은 권장사항은 아니지만, 가독성을 높여주기 때문에 단어 사이의 공간을 나타낼때 이용한다.

## 4.3 확신 없이는 앱을 확장하지 않는다
앱들은 될 수 있으면 작게 유지해야 한다. 거대한 크기의 앱 2~3개를 구성하는 것보다 작은 앱 여러개를 구성하는 것이 훨씬 나은 구성이다.

![]({{site.url}}/img/post/django/two_scoops/4.4.png)
> 한 가지 맛씩 담긴 두 컴의 아이스크림이 100가지 맛이 뒤죽박죽 섞인 거대한 아이스크림 통보다 훨씬 낫다.

## 4.4 엡 안에는 어떤 모듈이 위치하는가?
앱들 사이에는 공통으로 존재하는 모듈과 그렇지 않은 모듈이 있다.

### 4.4.1 공통 앱 모듈
99%의 장고 앱에서 보이는 일반적이 모듈들이다.

```
scoops/
    __init__.py
    admin.py
    forms.py
    management/
    migrations/
    models.py
    templatetags/
    tests/
    urls.py
    views.py
```
빗금(/)으로 끝나는 모듈은 하나 또는 여러 모듈을 내장할 수 있는 파이썬 패키지를 의미한다.  

파이썬과 장고의 유연성 덕분에 굳이 이 이름 규칙을 따라야 하는 것은 아니지만, 지키지 않는다면 비표준화로 인한 끔찍한 경험을 하게 될 것이다.

### 4.4.2 비공통 앱 모듈

```
scoops/
    behaviors.py
    constants.py
    context_processors.py
    decorators.py
    db/
    exceptions
    fields.py
    factories.py
    helpers.py
    managers.py
    middleware.py
    signals.py
    utils.py
    viewmixins.py
  ```

  - behaviors.py : 모델 믹스인 위치에 대한 옵션
  - constants.py : 앱 레벨에서 이용되는 세팅을 저장하는 장소의 이름으로 잘 지어진 이름이다. 하나의 앱에 다양한 셋팅이 있다면 이를 각 모듈로 분리하여 놓는 것이 프로젝트의 명확성을 위해 좋다.
  - decorators.py : 데코레이터가 존재하는 곳이다.
  - db/ : 여러 프로젝트에서 이용되는 커스텀 모델이나 컴포넌트
  - fields.py : 폼 필드 이용에 쓰인다. 때때로 db/ 패키지 생성으로도 충분하지 못한 필드가 존재할 때 모델 필드에 이용되기도 한다.
  - factories.py : 테스트 데이터 팩터리 파일이다.
  - helpers.py : 핼퍼 함수다. 뷰와 모델을 가볍게 하기 위해 뷰와 모델에서 추출한 코드를 저장하는 장소다. utils.py와 비슷한 기능을 한다.
  - managers.py : models.py가 너무 커질 경우, 일반적인 해결책으로 커스텀 모델 매니저가 여기로 이동된다.
  - signals.py : 커스텀 시그널을 제공하는 것에 대한 대안으로 커스텀 시그널을 넣기에 유용한 공간이다.
  - utils.py : helpers.py와 같은 기능이다.
  - viewmixins.py : 뷰 믹스인을 이 모듈로 이전함으로써 뷰 모델과 패키지를 더 가볍게 할 수 있다.

  여기에 나열된 모든 모듈은 전역 환경에서 이용되는 것이 아니라 앱 레벨에서 적용되는 것들이다.

## 4.5 요약
각 장고 앱은 그 앱 자체가 지닌 한 가지 역할에 초점이 맞추어져야 하며, 단순하고 쉽게 기억되는 이름을 가져야 한다. 앱의 기능이 너무 복잡하다면 여러 개의 작은 앱으로 나누어야 한다. 올바른 앱을 디자인하는 것은 많은 노력과 연습을 필요로 하지만 충분히 가치 있는 일이다.
