I"KØ<h1 id="build-a-rest-api-with-django--a-test-driven-approach-part-2">Build a REST API with Django â€“ A Test Driven Approach: Part 2</h1>

<p><a href="https://scotch.io/tutorials/build-a-rest-api-with-django-a-test-driven-approach-part-2">Build a REST API with Django â€“ A Test Driven Approach: Part 2</a>ì˜ í¬ìŠ¤íŒ…ì„ ë²ˆì—­í•œ ê²ƒì…ë‹ˆë‹¤.</p>

<blockquote>
  <p>The precondition to freedom is security â€“ Rand Beers</p>
</blockquote>

<p>ì¸ì¦ì€ API ë³´ì•ˆì˜ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ì…ë‹ˆë‹¤.</p>

<h2 id="table-of-content">Table of Content</h2>

<ul>
  <li>êµ¬í˜„í•˜ê¸°</li>
  <li>Refactoring Our Tests</li>
  <li>How To Pass Those Tests!</li>
  <li>What about Token-based Authentication?</li>
  <li>Run it</li>
  <li>Conclusion</li>
</ul>

<p>Django ê¸°ë°˜ bucketlist APIì—ì„œ ì‚¬ìš©ìë¥¼ ì¸ì¦í•˜ê³  ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ ë‹¤ë£¹ë‹ˆë‹¤.</p>

<h2 id="authenticationì¸ì¦-vs-authorizationìŠ¹ì¸">Authentication(ì¸ì¦) vs Authorization(ìŠ¹ì¸)</h2>

<p>Authentication(ì¸ì¦)ì€ ì¼ë°˜ì ìœ¼ë¡œ Authorization(ìŠ¹ì¸)ì™€ í˜¼ë™ë©ë‹ˆë‹¤. ì ˆëŒ€ ê°™ì€ ê²ƒì´ ì•„ë‹™ë‹ˆë‹¤.</p>

<p>ì¸ì¦ì€ ëˆ„êµ°ê°€ì˜ ì‹ ì›ì„ í™•ì¸í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.(ì‚¬ìš©ì ì´ë¦„, ì•”í˜¸, í† í°, í‚¤ ë“±)ê³¼ ê¶Œí•œ ë¶€ì—¬(ìŠ¹ì¸)ëŠ” ì¸ì¦ëœ ì‚¬ìš©ìì—ê²Œ ë¶€ì—¬ë˜ì–´ì•¼í•˜ëŠ” <strong>ì—‘ì„œìŠ¤ ìˆ˜ì¤€</strong> ì„ ê²°ì •í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>

<p>bucketlist APIë¥¼ ì‚´í´ë³´ë©´ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì‘ë™í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ bucketlistì„ ë§Œë“  ì‚¬ëŒ, ì²˜ìŒì— ì§€ì •ëœ ì‚¬ìš©ìê°€ ì¸ì¦ë˜ì—ˆëŠ”ì§€ ë˜ëŠ” bucketlistì— ë³€ê²½ ë‚´ìš©ì„ ì ìš© í•  ê¶Œí•œì´ ìˆëŠ”ì§€ ì—¬ë¶€ì™€ ê°™ì€ ê¸°ëŠ¥ì€ ì—†ìŠµë‹ˆë‹¤. ê·¸ê²ƒì„ ê³ ì³ì•¼ í•©ë‹ˆë‹¤.</p>

<p>ë¨¼ì € ì¸ì¦ì„ êµ¬í˜„í•˜ê³  ë‚˜ì¤‘ì— ì¼ë¶€ ì¸ì¦ ê¸°ëŠ¥ì„ ì‚­ì œí•©ë‹ˆë‹¤.</p>

<h2 id="êµ¬í˜„í•˜ê¸°">êµ¬í˜„í•˜ê¸°</h2>
<p>DRF APIì—ì„œ ì¸ì¦ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¨¼ì € ì‚¬ìš©ìë¥¼ ì¶”ì í•˜ì—¬ ì‹œì‘í•©ë‹ˆë‹¤.</p>

<p>ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”? DjangoëŠ” ìš°ë¦¬ê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ë³¸ ì‚¬ìš©ì ëª¨ë¸ì„ ì œê³µí•©ë‹ˆë‹¤.</p>

<p>Bucketlist ëª¨ë¸ì— owner í•„ë“œë¥¼ ë§Œë“­ë‹ˆë‹¤. ì‚¬ìš©ìê°€ bucklistì„ ë§Œë“œëŠ”ë°, bucketlistì€ ì†Œìœ ìê°€ ìˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ë”°ë¼ì„œ bucketlist ëª¨ë¸ì— ì‚¬ìš©ìì˜ í•„ë“œ ì •ì˜ë¥¼ ì¶”ê°€í•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/models.py
</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Bucketlist</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">'auth.User'</span><span class="p">,</span>  <span class="c1"># ADD THIS FIELD
</span>    <span class="n">related_name</span><span class="o">=</span><span class="s">'bucketlists'</span><span class="p">,</span>
    <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="p">.</span><span class="n">CASCADE</span><span class="p">)</span>
    <span class="n">date_created</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">date_modified</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></div>

<p>owner í•„ë“œëŠ” ì—¬ëŸ¬ ì¸ìˆ˜ë¥¼ í—ˆìš©í•˜ëŠ” <code class="language-plaintext highlighter-rouge">ForeignKey</code> í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì²« ë²ˆì§¸ â€˜auth.Userâ€™ëŠ” ê´€ê³„ë¥¼ ë§Œë“¤ë ¤ëŠ” ëª¨ë¸ í´ë˜ìŠ¤ë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">ForeignKey</code>ëŠ” ëª¨ë¸ í´ë˜ìŠ¤ì¸ â€˜auth.Userâ€™ì—ì„œ ê°€ì ¸ì™€ì„œ Userì™€ Bucketlist ëª¨ë¸ ê°„ì˜ ê´€ê³„ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.</p>

<p>ì´ ì‘ì—…ì„ í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ê¸° ìœ„í•´ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‹¤í–‰í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python  manage.py  makemigrations api
</code></pre></div></div>

<p>ê¸°ì¡´ í…Œì´ë¸”ì— ìƒˆ í•„ë“œë¥¼ ì“¸ ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ì„ íƒì§€ê°€ ë‚˜ì˜µë‹ˆë‹¤.</p>

<p><img src="/img/post/django/tda/4.png" alt="" /></p>

<p>ë°ì´í„°ë² ì´ìŠ¤ëŠ” nullì´ ì•„ë‹ˆê±°ë‚˜ non-nullable fieldë¥¼ ì¶”ê°€í•˜ë ¤ê³  í•œë‹¤ê³  ë¶ˆí‰í•©ë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ ê¸°ì¡´ ë°ì´í„°ê°€ ìˆìœ¼ë¯€ë¡œ ê°’ì„ ì…ë ¥í•´ì•¼í•©ë‹ˆë‹¤. ê°„ë‹¨í•œ í•´ê²°ë²•ì€ â€˜db.sqlite3â€™íŒŒì¼ê³¼ ë§ˆì´ê·¸ë ˆì´ì…˜ ë””ë ‰í† ë¦¬ë¥¼ ì‚­ì œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ â€¦ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì§€ìš°ëŠ” ê²ƒì´ë‹ˆ.. ì´ˆê¸°í™”ë©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•­ìƒ ìƒˆë¡œìš´ ê²ƒìœ¼ë¡œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ëª¨ë“  DB ë°ì´í„°ë¥¼ ì§€ìš°ê¸° ë•Œë¬¸ì— Prod í™˜ê²½ì—ì„œëŠ” ì ˆëŒ€ í•´ì„œëŠ” ì•ˆë©ë‹ˆë‹¤. ì´ë¥¼ ë” ê¹”ë”í•˜ê²Œ ìˆ˜ì •í•˜ëŠ” ë°©ë²•ì€ ì¼íšŒì„± ê¸°ë³¸ê°’ì„ ì œê³µí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë¬¼ë¡  DBì— ëŒ€í•œ ê¸°ë¡ì´ ì—†ë‹¤ë©´ ì‚­ì œí•´ë„ ë©ë‹ˆë‹¤.</p>

<p>ì´ë ‡ê²Œ í•œ ë‹¤ìŒ migrate ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ DBì— ë³€ê²½ ì‚¬í•­ì„ ì»¤ë°‹í•©ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python manage.py migrate
</code></pre></div></div>

<h2 id="refactoring-our-tests">Refactoring Our Tests</h2>
<p>ì§€ê¸ˆê¹Œì§€ëŠ” ìƒˆë¡œìš´ ì‚¬ìš©ì ì¸ì¦ê³¼ í•¨ê»˜ ì‘ë™í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ë¦¬í™í„°ë§í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<p>ìš°ì„ , ë¬´ì—‡ì„ ì¨ì•¼í•˜ëŠ”ì§€ ì•Œê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</p>

<ul>
  <li>ì‚¬ìš©ìì— ì˜í•œ Bucketlist ì†Œìœ ê¶Œ - ê¸°ë³¸ Django ì‚¬ìš©ì ëª¨ë¸ í†µí•©ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li>
  <li>ì¸ì¦ ëœ ì‚¬ìš©ìê°€ ìš”ì²­ì„ í–ˆëŠ”ì§€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤. ì¦‰, HTTP ìš”ì²­ì„ ë³´ë‚´ê¸° ì „ì— ì¸ì¦ì„ í•´ì•¼ í•©ë‹ˆë‹¤.</li>
  <li>bucketlist ì‘ì„±ì„ ì¸ì¦ ëœ ì‚¬ìš©ìë§Œ í•˜ë„ë¡ ì œí•œí•©ë‹ˆë‹¤.</li>
  <li>ê¸°ì¡´ bucketlistì„ ì†Œìœ ìë§Œ ì—‘ì„¸ìŠ¤ í•  ìˆ˜ ìˆë„ë¡ ì œí•œí•©ë‹ˆë‹¤.</li>
</ul>

<p>ì´ ì ë“¤ì€ í…ŒìŠ¤íŠ¸ë¥¼ ë¦¬í™í„°ë§í•˜ë„ë¡ ìœ ë„í•˜ëŠ”ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.</p>

<h3 id="modeltestcase-refactoring">ModelTestCase Refactoring</h3>

<p>ê¸°ë³¸ ì‚¬ìš©ì ëª¨ë¸(django.contrib.auth.User)ì„ í…ŒìŠ¤íŠ¸ ëª¨ë“ˆì— ê°€ì ¸ì™€ ì‚¬ìš©ìë¥¼ ë§Œë“­ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/tests.py
</span><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
</code></pre></div></div>

<p>setUp ë©”ì†Œë“œì—ì„œ Userë¥¼ ìƒì„±í•  ê²ƒì´ë¯€ë¡œ í…ŒìŠ¤íŠ¸í•  ë–„ë§ˆë‹¤ ì‚¬ìš©ìë¥¼ ìƒì„± í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ModelTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ê³¼ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ ë³€ìˆ˜ë¥¼ ì •ì˜í•©ë‹ˆë‹¤."""</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">"nerd"</span><span class="p">)</span> <span class="c1"># ADD THIS LINE
</span>     <span class="bp">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">"Write world class code"</span>
        <span class="c1"># bucketlistì„ ownerë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">bucketlist</span> <span class="o">=</span> <span class="n">Bucketlist</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">user</span><span class="p">)</span> <span class="c1"># EDIT THIS TOO
</span></code></pre></div></div>

<p>setUp ë©”ì†Œë“œì—ì„œ ì‚¬ìš©ì ì´ë¦„ì„ ê°€ì§„ ì‚¬ìš©ìë¥¼ ìƒì„±í•˜ì—¬ íƒœìŠ¤íŠ¸ ì‚¬ìš©ìë¥¼ ì •ì˜í–ˆìŠµë‹ˆë‹¤. ê·¸ ë‹¤ìŒ ì‚¬ìš©ìì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ bucketlist í´ë˜ìŠ¤ì— ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ì´ì œ ì‚¬ìš©ìëŠ” í•´ë‹¹ bucketlistì˜ ì†Œìœ ìê°€ ë©ë‹ˆë‹¤.</p>

<h3 id="viewstestcase-refactoring">ViewsTestCase Refactoring</h3>
<p>ë·°ëŠ” ì£¼ë¡œ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì¸ì¦ë˜ê³  ê¶Œí•œì´ ë¶€ì—¬ëœ ì‚¬ìš©ìë§Œ bucketlist APIì— ì—‘ì„œìŠ¤ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># rest_api/tests.py
# import fall here
</span>
<span class="c1"># Model Test Case is here
</span>
<span class="k">class</span> <span class="nc">ViewTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="s">"""api viewsë¥¼ ìœ„í•œ Test suite"""</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">""" í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ì™€ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ ë³€ìˆ˜ë¥¼ ì •ì˜í•©ë‹ˆë‹¤."""</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">"nerd"</span><span class="p">)</span>

        <span class="c1"># í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™”ì™€ ì¸ì¦ ê°•ì œ ì‚¬ìš©
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">APIClient</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">force_authenticate</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>

        <span class="c1"># ì‚¬ìš©ì ëª¨ë¸ ì¸ìŠ¤í„´ìŠ¤ëŠ” ì§ë ¬í™”í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ í•´ë‹¹ ID/PKë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">bucketlist_data</span> <span class="o">=</span> <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'Go to Ibiza'</span><span class="p">,</span> <span class="s">'owner'</span><span class="p">:</span> <span class="n">user</span><span class="p">.</span><span class="nb">id</span><span class="p">}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s">'create'</span><span class="p">),</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">bucketlist_data</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="s">"json"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_api_can_create_a_bucketlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">""" apiì— ë²„í‚· ìƒì„± ê¸°ëŠ¥ì´ ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤. """</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="p">.</span><span class="n">HTTP_201_CREATED</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_authorization_is_enforced</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""apiì— ì‚¬ìš©ì ê¶Œí•œì´ ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤."""</span>
        <span class="n">new_client</span> <span class="o">=</span> <span class="n">APIClient</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">new_client</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/bucketlists/'</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">'pk'</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="nb">format</span><span class="o">=</span><span class="s">"json"</span><span class="p">)</span>
        <span class="c1"># self.assertEqual(res.status_code, status.HTTP_403_FORBIDDEN)
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="p">.</span><span class="n">HTTP_401_UNAUTHORIZED</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_api_can_get_a_bucketlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">""""APIê°€ ì£¼ì–´ì§„ bucketlistì„ ì–»ì„ ìˆ˜ ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤."""</span>
        <span class="n">bucketlist</span> <span class="o">=</span> <span class="n">Bucketlist</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s">'/bucketlists/'</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">'pk'</span><span class="p">:</span> <span class="n">bucketlist</span><span class="p">.</span><span class="nb">id</span><span class="p">},</span> <span class="nb">format</span><span class="o">=</span><span class="s">"json"</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="p">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">bucketlist</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_api_can_update_bucketlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""APIê°€ íŠ¹ì • bucketlistì„ ì—…ë°ì´íŠ¸ í•  ìˆ˜ ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤."""</span>
        <span class="n">bucketlist</span> <span class="o">=</span> <span class="n">Bucketlist</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">change_bucketlist</span> <span class="o">=</span> <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'Something new'</span><span class="p">}</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">put</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s">'details'</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">'pk'</span><span class="p">:</span> <span class="n">bucketlist</span><span class="p">.</span><span class="nb">id</span><span class="p">}),</span>
            <span class="n">change_bucketlist</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">'json'</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="p">.</span><span class="n">HTTP_200_OK</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_api_can_delete_bucketlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""APIê°€ bucketlistì„ ì§€ìš¸ ìˆ˜ ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤."""</span>
        <span class="n">bucketlist</span> <span class="o">=</span> <span class="n">Bucketlist</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s">'details'</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">'pk'</span><span class="p">:</span> <span class="n">bucketlist</span><span class="p">.</span><span class="nb">id</span><span class="p">}),</span>
            <span class="nb">format</span><span class="o">=</span><span class="s">'json'</span><span class="p">,</span>
            <span class="n">follow</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">status</span><span class="p">.</span><span class="n">HTTP_204_NO_CONTENT</span><span class="p">)</span>
</code></pre></div></div>

<p>ApiClientë¥¼ ì´ˆê¸°í™”í•˜ê³  ì¸ì¦ì„ ì‚¬ìš©í•˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ APIì˜ ë³´ì•ˆì´ ê°•í™”ë©ë‹ˆë‹¤. bucketlist ì†Œìœ ê¶Œë„ ê³ ë ¤ë˜ì—ˆìŠµë‹ˆë‹¤. ë˜í•œ ê° í…ŒìŠ¤íŠ¸ ë°©ë²•ì´ì„œ ìƒˆë¡œìš´ í…ŒìŠ¤íŠ¸ ë°©ë²•ì„ ë§Œë“œëŠ” ëŒ€ì‹  â€˜self.clientâ€™ë¥¼ ì¼ê´€ë˜ê²Œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì— ì£¼ëª©í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” ì¸ì¦ëœ í´ë¼ì´ì–¸íŠ¸ë¥¼ ë‹¤ì‹œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤. ì¬ì‚¬ìš©ì€ ì¢‹ì€ ìŠµê´€ì…ë‹ˆë‹¤.</p>

<p>í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. ì§€ê¸ˆ ë‹¹ì¥ì€ ì‹¤íŒ¨í•©ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python manage.py test api
</code></pre></div></div>

<p>ë‹¤ìŒ ë‹¨ê³„ëŠ” ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ë„ë¡ ì½”ë“œë¥¼ ë¦¬íŒ©í„°ë§í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>

<h2 id="how-to-pass-those-tests">How To Pass Those Tests!</h2>

<h3 id="integrate-the-user">Integrate the User</h3>
<p>ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ëª¨ë¸ì—ì„œ ë³€ê²½ í•œ ì‚¬í•­ì€ serializerì—ë„ ë°˜ì˜ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” serializerê°€ ì´ìƒí•œ ëª¨ì–‘ì˜ ì¿¼ë¦¬ì…‹ì„ jsonìœ¼ë¡œ ë˜ëŠ” ê·¸ ë°˜ëŒ€ë¡œ ë³€ê²½í•˜ëŠ”ë° ë„ì›€ì´ ë˜ëŠ” ëª¨ë¸ê³¼ ì§ì ‘ ì¸í„°í˜ì´ìŠ¤í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>

<p>bucketlist serializerë¥¼ ìˆ˜ì •í•©ë‹ˆë‹¤. serializers.py íŒŒì¼ì—ì„œ ì‚¬ìš©ì ì§€ì • í•„ë“œë¥¼ ì‘ì„±í•˜ë©´, bucketlistì˜ ownerë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/serializers.py
</span>
<span class="k">class</span> <span class="nc">BucketlistSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="p">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="s">"""ëª¨ë¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ json í¬ë©§ìœ¼ë¡œ ë§¤í•‘í•˜ëŠ” serializerì…ë‹ˆë‹¤."""</span>

    <span class="n">owner</span> <span class="o">=</span> <span class="n">serializers</span><span class="p">.</span><span class="n">ReadOnlyField</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s">'owner.username'</span><span class="p">)</span> <span class="c1"># ADD THIS LINE
</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="s">"""serializer í•„ë“œë¥¼ ëª¨ë¸ í•„ë“œì™€ ë§¤í•‘í•˜ëŠ” ë©”íƒ€ í´ë˜ìŠ¤ì…ë‹ˆë‹¤."""</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Bucketlist</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'name'</span><span class="p">,</span> <span class="s">'owner'</span><span class="p">,</span> <span class="s">'date_created'</span><span class="p">,</span> <span class="s">'date_modified'</span><span class="p">)</span> <span class="c1"># ADD 'owner'
</span>        <span class="n">read_only_fields</span> <span class="o">=</span> <span class="p">(</span><span class="s">'date_created'</span><span class="p">,</span> <span class="s">'date_modified'</span><span class="p">)</span>
</code></pre></div></div>

<p>owner í•„ë“œëŠ” ì½ê¸° ì „ìš©ì´ë¯€ë¡œ APIë¥¼ ì‚¬ìš©í•˜ëŠ” ì‚¬ìš©ìëŠ” bucketlistì˜ ownerë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ìœ„ ì§€ì‹œëŒ€ë¡œ í•„ë“œì— ownerë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”.</p>

<p>ì œëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ë´…ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python manage.py runserver
</code></pre></div></div>

<p>localhostì—ì„œ ì ‘ê·¼í•  ë•Œ, ë‹¤ìŒê³¼ ê°™ì´ ë³´ì—¬ì•¼ í•©ë‹ˆë‹¤.</p>

<p><img src="/img/post/django/tda/5.png" alt="" /></p>

<p>ì´ì œ ìƒˆë¡œìš´ bucketlistë¥¼ ë§Œë“¤ ë•Œ ownerë¥¼ ì €ì¥í•˜ëŠ” ë°©ë²•ì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. bucketlist ì €ì¥ì€ ìš°ë¦¬ê°€ ì •ì˜í•œ views.pyíŒŒì¼ì˜ CreateViewë¼ëŠ” í´ë˜ìŠ¤ì—ì„œ ìˆ˜í–‰ë©ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">perform_create(self, serializer)</code> ë©”ì†Œë“œë¥¼ ì¶”ê°€í•˜ì—¬ CreateView í´ë˜ìŠ¤ë¥¼ í¸ì§‘í•©ë‹ˆë‹¤. ì´ ë©”ì„œë“œëŠ” serializerë¥¼ ì €ì¥í•˜ëŠ” ë°©ë²•ì„ ì œì–´í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/views.py
</span>
    <span class="k">def</span> <span class="nf">perform_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serializer</span><span class="p">):</span>
            <span class="s">"""ìƒˆ bucketlistë¥¼ ë§Œë“¤ ë•Œ post dataë¥¼ ì €ì¥í•©ë‹ˆë‹¤."""</span>
            <span class="n">serializer</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">user</span><span class="p">)</span> <span class="c1"># Add owner=self.request.user
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">serializer.save()</code>ëŠ” í•„ìˆ˜ ì¸ìˆ˜ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ownerë¥¼ ì§€ì •í–ˆìŠµë‹ˆë‹¤. ìš°ë¦¬ì˜ serializerëŠ” ê·¸ê²ƒì„ í•„ë“œê³  ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— serializerì˜ save ë©”ì†Œë“œì—ì„œ ownerë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ ë‹¤ìŒ ì‚¬ìš©ìì™€ í•¨ê»˜ bucketlistë¥¼ ownerë¡œ ì €ì¥í•©ë‹ˆë‹¤.</p>

<p>bucketlistë¥¼ ë§Œë“¤ë ¤ê³  í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>

<p><img src="/img/post/django/tda/6.png" alt="" /></p>

<p>owner ì§€ì •ì—†ì´ ë¸Œë¼ìš°ì €ì—ì„œ bucketlistë¥¼ ì €ì¥í•˜ë ¤ í–ˆê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>

<p>serializerê°€ bucketlistì˜ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ê³  ì €ì¥í•˜ê¸° ì „ì— ìƒˆë¡œìš´ nullableì´ ì•„ë‹Œ owner í•„ë“œì— ê°’ì´ í•„ìš”í•©ë‹ˆë‹¤. ë¬¸ì œë¥¼ í•´ê²°í•´ ë´…ì‹œë‹¤.</p>

<p>urls.pyì—ëŠ” bucketlistë¥¼ ë§Œë“¤ê¸° ì „ì— ì‚¬ìš©ìê°€ apiì— ë¡œê·¸ì¸í•  ìˆ˜ ìˆëŠ” ê²½ë¡œë¥¼ ì¶”ê°€í•  ê²ƒì…ë‹ˆë‹¤. bucketlistì— ownerë¥¼ ë‘ê¸° ìœ„í•´, ì¦‰ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ bucketlistë¥¼ ë§Œë“¤ê¸°ë¡œ ê²°ì •í•˜ëŠ” ê²½ìš° ì´ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/urls.py
</span>
<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s">'^auth/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'rest_framework.urls'</span><span class="p">,</span> <span class="c1"># ADD THIS URL
</span>                               <span class="n">namespace</span><span class="o">=</span><span class="s">'rest_framework'</span><span class="p">)),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s">'^bucketlists/$'</span><span class="p">,</span> <span class="n">CreateView</span><span class="p">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">"create"</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s">'^bucketlists/(?P&lt;pk&gt;[0-9]+)/$'</span><span class="p">,</span>
        <span class="n">DetailsView</span><span class="p">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">"details"</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">format_suffix_patterns</span><span class="p">(</span><span class="n">urlpatterns</span><span class="p">)</span>
</code></pre></div></div>

<p>ì¶”ê°€í•œ ì½”ë“œëŠ” ì‚¬ìš©ìë¥¼ ì¸ì¦í•˜ëŠ” ê¸°ë³¸ ë¡œê·¸ì¸ í…œí”Œë¦¿ì„ ì œê³µí•˜ëŠ” DRF ê²½ë¡œê°€ í¬í•¨ë©ë‹ˆë‹¤.</p>

<p>íŒŒì¼ì„ ì €ì¥í•˜ë©´ ì‹¤í–‰ì¤‘ì¸ ì„œë²„ ì¸ìŠ¤í„´ìŠ¤ëŠ” ì¬ë™ìœ¼ë¡œ ìƒˆë¡œ ê³ ì³ì§‘ë‹ˆë‹¤.</p>

<p><a href="http://localhost:8000/bucketlists/">http://localhost:8000/bucketlists/</a>ìœ¼ë¡œ ì ‘ì† í›„ ì˜¤ë¥¸ìª½ ìƒë‹¨ì˜ ë¡œê·¸ì¸ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ë¡œê·¸ì¸ í…œí”Œë¦¿ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜ ë©ë‹ˆë‹¤.</p>

<p><img src="/img/post/django/tda/7.png" alt="" /></p>

<p>ë¡œê·¸ì¸ í•  ê´€ë¦¬ì ê³„ì •ì„ ë§Œë“­ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python manage.py createsuperuser
</code></pre></div></div>

<p>ê·¸ë¦¬ê³  ë¡œê·¸ì¸ì„ í•©ë‹ˆë‹¤.</p>

<h3 id="authorization-adding-permissions">Authorization: Adding permissions</h3>
<p>í˜„ì¬ ëª¨ë“  ì‚¬ìš©ìëŠ” bucketlistë¥¼ ë³´ê³  í¸ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì†Œìœ ìë§Œ bucketlistë¥¼ í¸ì§‘, ì‚­ì œë¥¼ í•  ìˆ˜ ìˆë„ë¡ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h4 id="a-default-permission-check">A default permission check</h4>
<p>ê¸°ë³¸ ê¶Œí•œ íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ì¦ ëœ ì‚¬ìš©ìì—ê²Œë§Œ bucketlist ì—‘ì„¸ìŠ¤ë¥¼ ì œí•œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>views.pyì—ì„œ <code class="language-plaintext highlighter-rouge">permissions</code> í´ë˜ìŠ¤ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">rest_framework</span> <span class="kn">import</span> <span class="n">permissions</span>
</code></pre></div></div>

<p>CreateView í´ë˜ìŠ¤ì— permission í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/views.py
</span>
<span class="k">class</span> <span class="nc">CreateView</span><span class="p">(</span><span class="n">generics</span><span class="p">.</span><span class="n">ListCreateAPIView</span><span class="p">):</span>
    <span class="s">"""This class handles the GET and POSt requests of our rest api."""</span>
    <span class="n">queryset</span> <span class="o">=</span> <span class="n">Bucketlist</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
    <span class="n">serializer_class</span> <span class="o">=</span> <span class="n">BucketlistSerializer</span>
    <span class="n">permission_classes</span> <span class="o">=</span> <span class="p">(</span><span class="n">permissions</span><span class="p">.</span><span class="n">IsAuthenticated</span><span class="p">,)</span> <span class="c1"># ADD THIS LINE
</span></code></pre></div></div>

<p>permission í´ë˜ìŠ¤ì¸ <code class="language-plaintext highlighter-rouge">IsAuthenticated</code>ëŠ” ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìì—ê²Œ ê¶Œí•œì„ ê±°ë¶€í•˜ê³ , ì¸ì¦ëœ ì‚¬ìš©ìëŠ” ê¶Œí•œì„ í—ˆìš©í•©ë‹ˆë‹¤. ìš”ì²­ì´ â€œì•ˆì „í•œ ë°©ë²•â€(GET, HEAD, OPTIONS) ì¤‘ í•˜ë‚˜ë©´ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìë¥¼ í—ˆìš©í•˜ëŠ” <code class="language-plaintext highlighter-rouge">IsAuthenticatedOrReadOnly</code>ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” ì•ˆì „í•œ ë³´ì•ˆì„ ì›í•©ë‹ˆë‹¤.</p>

<h4 id="custom-permission">Custom Permission</h4>
<p>í˜„ì¬ ì¸ì¦ëœ ì‚¬ìš©ìëŠ” ë‹¤ë¥¸ ì‚¬ìš©ìì˜ bucketlistë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ownerì— ëŒ€í•œ ì™„ì „í•œ ê°œë…ì„ êµ¬í˜„í•˜ë ¤ë©´ custom permissionì„ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.</p>

<p>api ë””ë ‰í„°ë¦¬ ì•ˆì— permissions.pyì„ ìƒì„±í•˜ê³  ë‹¤ìŒì˜ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/permissions.py
</span>
<span class="kn">from</span> <span class="nn">rest_framework.permissions</span> <span class="kn">import</span> <span class="n">BasePermission</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Bucketlist</span>

<span class="k">class</span> <span class="nc">IsOwner</span><span class="p">(</span><span class="n">BasePermission</span><span class="p">):</span>
    <span class="s">"""bucketlist ownerë§Œ ìˆ˜ì • ê¶Œí•œì„ ë¶€ì—¬í•  ìˆ˜ ìˆëŠ” custom permission í´ë˜ìŠ¤ì…ë‹ˆë‹¤."""</span>

    <span class="k">def</span> <span class="nf">has_object_permission</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="s">"""bucketlist ownerì—ê²Œ ê¶Œí•œì´ ë¶€ì—¬ë˜ë©´ Trueë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤."""</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Bucketlist</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">obj</span><span class="p">.</span><span class="n">owner</span> <span class="o">==</span> <span class="n">request</span><span class="p">.</span><span class="n">user</span>
        <span class="k">return</span> <span class="n">obj</span><span class="p">.</span><span class="n">owner</span> <span class="o">==</span> <span class="n">request</span><span class="p">.</span><span class="n">user</span>
</code></pre></div></div>

<p>ìœ„ í´ë˜ìŠ¤ëŠ” ì´ëŸ¬í•œ ì‚¬ì‹¤ì„ ìœ ì§€í•˜ëŠ” ì‚¬ìš© ê¶Œí•œì„ êµ¬í˜„í•©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ í•´ë‹¹ ê°œì²´ì˜ ì‚¬ìš© ê¶Œí•œì„ ê°€ì§€ë ¤ë©´ ì‚¬ìš©ìê°€ ownerì´ì—¬ì•¼ í•©ë‹ˆë‹¤. ì‚¬ìš©ìê°€ bucketlistì˜ ownerë¼ë©´ Trueë¥¼ ë°˜í™˜í•˜ê³ , ì•„ë‹ˆë¼ë©´ Falseë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</p>

<p>ìš°ë¦¬ëŠ” permission_classes íŠœí”Œ ì•ˆì— ì¶”ê°€í•´ì•¼ ì…‹íŒ…ë©ë‹ˆë‹¤. ëª…í™•í•˜ê²Œ í•˜ê¸° ìœ„í•´, ì—…ë°ì´íŠ¸ ëœ viewëŠ” ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/views.py
</span>
<span class="kn">from</span> <span class="nn">rest_framework</span> <span class="kn">import</span> <span class="n">generics</span><span class="p">,</span> <span class="n">permissions</span>
<span class="kn">from</span> <span class="nn">.permissions</span> <span class="kn">import</span> <span class="n">IsOwner</span>
<span class="kn">from</span> <span class="nn">.serializers</span> <span class="kn">import</span> <span class="n">BucketlistSerializer</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Bucketlist</span>

<span class="k">class</span> <span class="nc">CreateView</span><span class="p">(</span><span class="n">generics</span><span class="p">.</span><span class="n">ListCreateAPIView</span><span class="p">):</span>
    <span class="s">"""This class handles the GET and POSt requests of our rest api."""</span>
    <span class="n">queryset</span> <span class="o">=</span> <span class="n">Bucketlist</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
    <span class="n">serializer_class</span> <span class="o">=</span> <span class="n">BucketlistSerializer</span>
    <span class="n">permission_classes</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">permissions</span><span class="p">.</span><span class="n">IsAuthenticated</span><span class="p">,</span> <span class="n">IsOwner</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">perform_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serializer</span><span class="p">):</span>
        <span class="s">"""Save the post data when creating a new bucketlist."""</span>
        <span class="n">serializer</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">owner</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">user</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">DetailsView</span><span class="p">(</span><span class="n">generics</span><span class="p">.</span><span class="n">RetrieveUpdateDestroyAPIView</span><span class="p">):</span>
    <span class="s">"""This class handles GET, PUT, PATCH and DELETE requests."""</span>

    <span class="n">queryset</span> <span class="o">=</span> <span class="n">Bucketlist</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
    <span class="n">serializer_class</span> <span class="o">=</span> <span class="n">BucketlistSerializer</span>
    <span class="n">permission_classes</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">permissions</span><span class="p">.</span><span class="n">IsAuthenticated</span><span class="p">,</span>
        <span class="n">IsOwner</span><span class="p">)</span>
</code></pre></div></div>

<p>ë¡œê·¸ì•„ì›ƒí•˜ê³  bucketlitsë¥¼ ì–»ìœ¼ë ¤ê³  í•˜ë©´ <code class="language-plaintext highlighter-rouge">HTTP 403 Forbidden</code> ì‘ë‹µì„ ë°›ê²Œ ë©ë‹ˆë‹¤. ì´ê²ƒì„ ì¸ì¦ê³¼ ê¶Œí•œ ë¶€ì—¬ê°€ ì˜ ì‘ë™ë˜ê³  ìˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>

<p><img src="/img/post/django/tda/8.png" alt="" /></p>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python manage.py test
Creating test database for alias 'default'...
System check identified no issues (0 silenced).
.....
----------------------------------------------------------------------
Ran 5 tests in 0.045s

OK
Destroying test database for alias 'default'...
</code></pre></div></div>

<h2 id="what-about-token-based-authentication">What about Token-based Authentication?</h2>
<p>í† í° ì¸ì¦ì€ íŠ¹íˆ í´ë¼ì´ì–¸íŠ¸ê°€ PCë‚˜ Mobileì¸ ê²½ìš° í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ì„¤ì •ì— ì í•©í•©ë‹ˆë‹¤.</p>

<p>ì‘ë™ ë°©ë²•ì€ ì´ëŸ¬í•©ë‹ˆë‹¤.</p>
<ul>
  <li>ì‚¬ìš©ìê°€ ì„œë²„ì— ë³´ì•ˆ í† í°ì„ ìš”ì²­í•©ë‹ˆë‹¤.</li>
  <li>ì„œë²„ëŠ” í† í°ì„ ìƒì„±í•˜ê³  ì´ë¥¼ ì‚¬ìš©ìì™€ ì—°ê´€ì‹œí‚µë‹ˆë‹¤.</li>
  <li>í† í°ì„ ë³´ë‚¸ í›„ ì„œë²„ëŠ” ì‚¬ìš©ìê°€ í•´ë‹¹ í† í°ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬ì†ŒìŠ¤ë¥¼ ìš”ì²­í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.</li>
  <li>ê·¸ëŸ° ë‹¤ìŒ ì‚¬ìš©ìëŠ” í† í°ì„ ì‚¬ìš©í•˜ì—¬ ì‹¤ì œë¡œ ìœ íš¨í•œ ì‚¬ìš©ìì„ì„ ì„œë²„ì— ì¸ì¦í•˜ê³  ì¦ëª…í•©ë‹ˆë‹¤.</li>
</ul>

<p>APIì— í† í° ì¸ì¦ì„ ì‚¬ìš©í•˜ë ¤ë©´ settings.pyì— ì¼ë¶€ êµ¬ì„±ì„ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># project/settings.py
</span>
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">'django.contrib.admin'</span><span class="p">,</span>
    <span class="s">'django.contrib.auth'</span><span class="p">,</span>
    <span class="s">'django.contrib.contenttypes'</span><span class="p">,</span>
    <span class="s">'django.contrib.sessions'</span><span class="p">,</span>
    <span class="s">'django.contrib.messages'</span><span class="p">,</span>
    <span class="s">'django.contrib.staticfiles'</span><span class="p">,</span>
    <span class="s">'rest_framework'</span><span class="p">,</span>
    <span class="s">'rest_api'</span><span class="p">,</span>
    <span class="s">'rest_framework.authtoken'</span> <span class="c1"># ADD THIS LINE
</span><span class="p">)</span>
</code></pre></div></div>

<p>ì‚¬ìš©ìë¥¼ ìƒì„±í•  ë•Œë§ˆë‹¤ ë³´ì•ˆ í† í°ì„ ë§Œë“¤ê³  ì‹¶ìŠµë‹ˆë‹¤. ì‚¬ìš©ì ìƒì„±ì‹œ í† í° ìƒì„±ë„ íŠ¸ë¦¬ê±°ë˜ë„ë¡ í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?</p>

<p>ì‹ í˜¸ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.</p>

<p>ì‚¬ìš©ìê°€ ìƒì„±ë˜ë©´ ì‚¬ìš©ì ëª¨ë¸ì— ì˜í•´ <code class="language-plaintext highlighter-rouge">post_save</code> ì‹ í˜¸ê°€ ë°œìƒí•©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ receiverê°€ ì´ <code class="language-plaintext highlighter-rouge">post_save</code> ì‹ í˜¸ë¥¼ í¬ì°©í•˜ê³  í† í°ì„ ì¦‰ì‹œ ìƒì„±í•˜ëŠ”ë° ë„ì›€ì„ ì¤ë‹ˆë‹¤.</p>

<p>receiverëŠ” models.py ì•ˆì— ìˆìŠµë‹ˆë‹¤. ì¶”ê°€í•  importë“¤ ì…ë‹ˆë‹¤.</p>
<ul>
  <li>post_save signal</li>
  <li>default User model</li>
  <li>Token model</li>
  <li>receiver</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/models.py
</span>
<span class="c1"># rest_api/models.py
</span><span class="kn">from</span> <span class="nn">django.db.models.signals</span> <span class="kn">import</span> <span class="n">post_save</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>
<span class="kn">from</span> <span class="nn">rest_framework.authtoken.models</span> <span class="kn">import</span> <span class="n">Token</span>
<span class="kn">from</span> <span class="nn">django.dispatch</span> <span class="kn">import</span> <span class="n">receiver</span>

<span class="k">class</span> <span class="nc">Bucketlist</span><span class="p">(</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="s">"""This class represents the bucketlist model."""</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">owner</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">'auth.User'</span><span class="p">,</span>
        <span class="n">related_name</span><span class="o">=</span><span class="s">'bucketlists'</span><span class="p">,</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="p">.</span><span class="n">CASCADE</span><span class="p">)</span>
    <span class="n">date_created</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">date_modified</span> <span class="o">=</span> <span class="n">models</span><span class="p">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""Return a human readable representation of the model instance."""</span>
        <span class="k">return</span> <span class="s">"{}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># This receiver handles token creation immediately a new user is created.
</span><span class="o">@</span><span class="n">receiver</span><span class="p">(</span><span class="n">post_save</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="n">User</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">create_auth_token</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">created</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">created</span><span class="p">:</span>
        <span class="n">Token</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">create</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">instance</span><span class="p">)</span>
</code></pre></div></div>

<p>receiverëŠ” <strong>Bucketlist ëª¨ë¸ í´ë˜ìŠ¤ ì•ˆì— ë“¤ì—¬ ì“°ê¸°ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.</strong></p>

<p>ë˜í•œ ì‚¬ìš©ìê°€ í† í°ì„ ì–»ì„ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤. URLì´ ê·¸ ë°©ë²•ì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/urls.py
</span><span class="kn">from</span> <span class="nn">rest_framework.authtoken.views</span> <span class="kn">import</span> <span class="n">obtain_auth_token</span> <span class="c1"># add this import
</span>
<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'bucketlists/'</span><span class="p">,</span> <span class="n">CreateView</span><span class="p">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">"create"</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'bucketlists/&lt;pk&gt;/'</span><span class="p">,</span>
        <span class="n">DetailsView</span><span class="p">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">"details"</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'auth/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'rest_framework.urls'</span><span class="p">,</span>
                           <span class="n">namespace</span><span class="o">=</span><span class="s">'rest_framework'</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'users/'</span><span class="p">,</span> <span class="n">UserView</span><span class="p">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">"users"</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'users/&lt;pk&gt;/'</span><span class="p">,</span>
        <span class="n">UserDetailsView</span><span class="p">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s">"user_details"</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s">'get-token/'</span><span class="p">,</span> <span class="n">obtain_auth_token</span><span class="p">),</span> <span class="c1"># Add this line
</span><span class="p">}</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">format_suffix_patterns</span><span class="p">(</span><span class="n">urlpatterns</span><span class="p">)</span>
</code></pre></div></div>

<blockquote>
  <p>ì¤‘ê°„ì— UserView, UserDetailsViewê°€ ê°‘ìê¸° ìƒê²¼ë‹¤. ì›ì‘ìê°€ ì‹¤ìˆ˜ë¡œ ë¹¼ë¨¹ì€ ë“¯ í•˜ë‹¤.
ë¹ ì§„ ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/views.py
</span><span class="k">class</span> <span class="nc">UserView</span><span class="p">(</span><span class="n">generics</span><span class="p">.</span><span class="n">ListAPIView</span><span class="p">):</span>
    <span class="s">"""View to list the user queryset."""</span>
    <span class="n">queryset</span> <span class="o">=</span> <span class="n">User</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
    <span class="n">serializer_class</span> <span class="o">=</span> <span class="n">UserSerializer</span>


<span class="k">class</span> <span class="nc">UserDetailsView</span><span class="p">(</span><span class="n">generics</span><span class="p">.</span><span class="n">RetrieveAPIView</span><span class="p">):</span>
    <span class="s">"""View to retrieve a user instance."""</span>
    <span class="n">queryset</span> <span class="o">=</span> <span class="n">User</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">()</span>
    <span class="n">serializer_class</span> <span class="o">=</span> <span class="n">UserSerializer</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># api/serializers.py
</span>
<span class="k">class</span> <span class="nc">UserSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="p">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="s">"""ì¸ì¦ê³¼ ìŠ¹ì¸ì— ë„ì›€ì´ ë˜ëŠ” serializer"""</span>

    <span class="n">bucketlists</span> <span class="o">=</span> <span class="n">serializers</span><span class="p">.</span><span class="n">PrimaryKeyRelatedField</span><span class="p">(</span>
        <span class="n">many</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">queryset</span><span class="o">=</span><span class="n">Bucketlist</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">all</span><span class="p">())</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="s">"""serializerë¥¼ ê¸°ë³¸ django ì‚¬ìš©ì ëª¨ë¸ì— ë§¤í•‘í•©ë‹ˆë‹¤."""</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">User</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">(</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'username'</span><span class="p">,</span> <span class="s">'bucketlists'</span><span class="p">)</span>
</code></pre></div></div>

<p>DRFëŠ” ì‚¬ìš©ìê°€ ì‚¬ìš©ì ì´ë¦„ê³¼ ì•”í˜¸ë¥¼ ì…ë ¥í•  ë•Œ í† í°ì„ ì–»ëŠ”ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë·°ê°€ ë‚´ì¥ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>

<p>ë§ˆì´ê·¸ë ˆì´ì…˜ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ë©´ ì´ ë·°ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python manage.py makemigrations api &amp;&amp; python manage.py migrate
</code></pre></div></div>

<p>ë§ˆì§€ë§‰ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">BasicAuthentication</code>ê³¼ <code class="language-plaintext highlighter-rouge">TokenAuthentication</code>ìœ¼ë¡œ ì¸ì¦ í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •ì— ì¶”ê°€í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># project/settings.py
</span>
<span class="n">REST_FRAMEWORK</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'DEFAULT_PERMISSION_CLASSES'</span><span class="p">:</span> <span class="p">(</span>
        <span class="s">'rest_framework.permissions.IsAuthenticated'</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="s">'DEFAULT_AUTHENTICATION_CLASSES'</span><span class="p">:</span> <span class="p">(</span>
        <span class="s">'rest_framework.authentication.BasicAuthentication'</span><span class="p">,</span>
        <span class="s">'rest_framework.authentication.TokenAuthentication'</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">DEFAULT_AUTHENTICATION_CLASSES</code> ì„¤ì •ì€ ì‚¬ìš©ìì—ê²Œ ì—¬ëŸ¬ê°€ì§€ ì¸ì¦ ë°©ë²•ì„ êµ¬ì„±í•  ê²ƒì„ ì•±ì— ì•Œë ¤ì¤ë‹ˆë‹¤. ì´ íŠœí”Œ ë‚´ë¶€ì— ë‚´ì¥ëœ ì¸ì¦ í´ë˜ìŠ¤ë¥¼ ì°¸ì¡°í•˜ì—¬ ë°©ë²•ì„ ì§€ì •í•©ë‹ˆë‹¤.</p>

<h2 id="run-it">Run it</h2>
<p>íŒŒì¼ì„ ì €ì¥í•˜ë©´, ì„œë²„ê°€ ì´ë¯¸ ì‹¤í–‰ì¤‘ì¸ ê²½ìš° ì¶”ê°€ ë³€ê²½ëœ ì‚¬í•­ì„ ìë™ìœ¼ë¡œ ì ìš©í•´ ì¬ì‹œì‘í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì„œë²„ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì¬ì‹œì‘í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>

<p>ì‹œê°ì ìœ¼ë¡œ APIê°€ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ Postmanì— HTTP ìš”ì²­ì„ í•©ë‹ˆë‹¤.</p>

<h3 id="postman-step-1-obtain-that-token">Postman Step 1: Obtain that token</h3>

<p>í´ë¼ì´ì–¸íŠ¸ê°€ ì¸ì¦ì„ ë°›ìœ¼ë ¤ë©´ íšë“ ëœ í† í°ì´ <code class="language-plaintext highlighter-rouge">Authorization</code> HTTP í—¤ë”ì— í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. Tokenì´ë¼ëŠ” ë‹¨ì–´ ì•ì— ê³µë°± ë¬¸ìë¥¼ ë¶™ì…ë‹ˆë‹¤. í—¤ë”ëŠ” ë‹¤ìŒê³¼ ê°™ì•„ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Authorization: Token 2777b09199c62bcf9418ad846dd0e4bbdfc6ee4b
</code></pre></div></div>

<p>ë¹ˆ ì¹¸ì„ ìŠìœ¼ë©´ ì•ˆë©ë‹ˆë‹¤.</p>

<p>í”„ë¡œì„¸ìŠ¤ì—ì„œ ì‚¬ìš©ì ì´ë¦„ê³¼ ì•”í˜¸ë¥¼ ì§€ì •í•˜ì—¬ â€˜http://localhost:8000/get-token/â€™ì— post ìš”ì²­ì„ í•©ë‹ˆë‹¤.</p>

<p><img src="/img/post/django/tda/9.png" alt="" /></p>

<h3 id="postman-step-2-use-obtained-token-in-authorization-header">Postman Step 2: Use obtained token in Authorization header</h3>

<p>ì´í›„ ìš”ì²­ì— ëŒ€í•´ì„œëŠ” API ë¦¬ì†ŒìŠ¤ì— ì—‘ì„¸ìŠ¤í•˜ë ¤ë©´ Authorization í—¤ë”ë¥¼ í¬í•¨í•˜ì•¼ í•©ë‹ˆë‹¤.</p>

<p>ì—¬ê¸°ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆëŠ”ë°, ì¼ë°˜ì ìœ¼ë¡œ Authorization í—¤ë”ì— ì˜ëª» ëœ í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ë‹¤ìŒì€ ì„œë²„ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ ë©”ì‹œì§€ì…ë‹ˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "detail": "Authentication credentials were not provided."
}
</code></pre></div></div>
<p><img src="/img/post/django/tda/10_1.png" alt="" /></p>

<p>â€˜Token <your-new-token-is-here>' í˜•ì‹ìœ¼ë¡œ ì…ë ¥í–ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ë§Œì•½ bearerì™€ ê°™ì´ í—¤ë”ì— ë‹¤ë¥¸ í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´, TokenAuthenticationì„ í•˜ìœ„ í´ë˜ìŠ¤ë¡œ ë§Œë“¤ê³  í‚¤ì›Œë“œ í´ë˜ìŠ¤ ë³„ìˆ˜ë¥¼ ì„¤ì •í•˜ì„¸ìš”.</your-new-token-is-here></p>

<p>GET ìš”ì²­ì„ ë³´ë‚´ë´…ì‹œë‹¤, ë‹¤ìŒê³¼ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤.</p>

<p><img src="/img/post/django/tda/11.png" alt="" /></p>

<p>ì´ì œ ë³´ì•ˆì´ ì˜ ì„¤ì •ëœ APIì—ì„œ ììœ ë¡­ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h2 id="conclusion">Conclusion</h2>
<p>ì‚¬ìš©ì ì¸ì¦ êµ¬í˜„ì—ì„œ ì¸ì¦ êµ¬í˜„ì„ ìœ„í•œ ê¶Œí•œ ìƒì„±ì— ì´ë¥´ê¸°ê¹Œì§€ Django APIë¥¼ ì•ˆì „í•˜ê²Œ ë³´í˜¸í–ˆìŠµë‹ˆë‹¤.</p>

<p>ë˜í•œ ëª¨ë°”ì¼ê³¼ PCê°€ ì•ˆì „í•˜ê²Œ APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í† í° ê¸°ë°˜ ì¸ì¦ ë ˆì´ì–´ë¥¼ í¸ë¦¬í•˜ê²Œ ì •ì˜í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ ë³€ê²½ ì‚¬í•­ì„ ìˆ˜ìš©í•˜ê¸° ìœ„í•´ í…ŒìŠ¤íŠ¸ë¥¼ ë¦¬íŒ©í„°ë§í–ˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ê²ƒì€ ë§¤ìš° ì¤‘ìš”í•˜ë©° TDAì˜ í•µì‹¬ì…ë‹ˆë‹¤.</p>
:ET