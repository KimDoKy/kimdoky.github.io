I"Àª<blockquote>
  <p><a href="https://www.feldroy.com/books/two-scoops-of-django-3-x">Two Scoops of Django 3.x</a></p>
</blockquote>

<hr />

<h2 id="241-testing-saves-money-jobs-and-lives">24.1 Testing Saves Money, Jobs, and Lives</h2>

<p>ëˆ, ì§ì¥, ì‹¬ì§€ì–´ ìƒëª…ê³¼ë„ ì—°ê´€ë˜ì–´ ìˆëŠ” í…ŒìŠ¤íŒ…</p>

<ul>
  <li>NASAì˜ â€˜smoke testâ€™ ì˜ˆ
    <ul>
      <li>í…ŒìŠ¤íŠ¸ëŠ” ë§‰ëŒ€í•œ ì˜ˆì‚°, ì—°ê´€ëœ íšŒì‚¬ ì§ì›ë“¤ì˜ ì§ì¥, ê³¼í•™ìë“¤ê³¼ ìš°ì£¼ì¸ì˜ ìƒëª…ê¹Œì§€ë„ ì§€í‚µë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p>í…ŒìŠ¤íŠ¸ëŠ” NASA ë¿ë§Œ ì•„ë‹ˆë¼ Djangoì—ì„œë„ ì¤‘ìš”í•©ë‹ˆë‹¤.</p>

<ul>
  <li>coverage.py
    <ul>
      <li>í…ŒìŠ¤íŒ…ì„ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬</li>
      <li>ì½”ë“œì˜ ì–´ë–¤ ë¶€ë¶„ì´ í…ŒìŠ¤íŠ¸ë˜ì—ˆê³ , ì–´ë–¤ ë¼ì¸ë“¤ì´ í…ŒìŠ¤íŠ¸ë˜ì§€ ì•Šì•˜ëŠ”ì§€ ëª…í™•íˆ ì•Œë ¤ì¤Œ</li>
      <li>ë¬¼ë¡  ì»¤ë²„ë¦¬ì§€ê°€ 100%ë¼ê³  í•´ì„œ ë²„ê·¸ê°€ ì—†ëŠ” ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, ë„ì›€ì´ ë˜ëŠ” ê²ƒì€ í™•ì‹¤</li>
    </ul>
  </li>
</ul>

<h2 id="242-how-to-structure-tests">24.2 How to Structure Tests</h2>

<p>ì–´ë–»ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ êµ¬ì¶•í•  ê²ƒì¸ê°€</p>

<p>ìš°ì„  ë¶ˆí•„ìš”í•œ <a href="http://test.py">test.py</a> ëª¨ë“ˆë“¤ì„ ì§€ì›ë‹ˆë‹¤.</p>

<p>ê·¸ í›„ ëŒ€ë¶€ë¶„ì˜ ì•±ì—ì„œ í•„ìš”ë¡œ í•˜ëŠ” <code class="language-plaintext highlighter-rouge">test_form.py</code>, <code class="language-plaintext highlighter-rouge">test_models.py</code>, <code class="language-plaintext highlighter-rouge">test_views.py</code>ì™€ ê°™ì€ ëª¨ë“ˆë“¤ì„ ì§ì ‘ ìƒˆë¡œ ìƒì„±í•©ë‹ˆë‹¤.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>popsicles/
    __init__.py
    admin.py
    forms.py
    models.py
    tests/
        __init__.py
        test_forms.py
        test_models.py
        test_views.py
				...
		views.py
</code></pre></div></div>

<p>í…ŒìŠ¤íŠ¸ ëª¨ë“ˆë“¤ì€ ë°˜ë“œì‹œ <code class="language-plaintext highlighter-rouge">test_</code> ì ‘ë‘ì–´ë¥¼ ë¶™ì—¬ì•¼ë§Œ í•©ë‹ˆë‹¤. ê·¸ë˜ì•¼ë§Œ Djangoì˜ í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆê°€ í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ ì¸ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h2 id="243-how-to-write-unit-tests">24.3 How to Write Unit Tests</h2>

<p>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±í•˜ê¸°</p>

<p>ìµœì†Œí•œì˜ ì‹œê°„ì— ê°€ì¥ ì˜ë¯¸ìˆëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>

<h3 id="2431-each-test-method-tests-one-thing">24.3.1 Each Test Method Tests One Thing</h3>

<p>ê° í…ŒìŠ¤íŠ¸ ë©”ì„œë“œëŠ” í…ŒìŠ¤íŠ¸ë¥¼ í•œê°€ì§€ì”© ìˆ˜í–‰í•´ì•¼ í•œë‹¤.</p>

<p>í…ŒìŠ¤íŠ¸ ë©”ì„œë“œëŠ” í…ŒìŠ¤íŠ¸ ë²”ìœ„ê°€ ì¢ì•„ì•¼ í•©ë‹ˆë‹¤.</p>

<p>í•˜ë‚˜ì˜ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ì—¬ëŸ¬ ê°œì˜ ë·°ë‚˜ ëª¨ë¸ í¼ í˜¹ì€ í•œ í´ë˜ìŠ¤ ì•ˆì˜ ì—¬ëŸ¬ ë©”ì„œë“œì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ë©´ ì•ˆë©ë‹ˆë‹¤.</p>

<p>í•˜ë‚˜ì˜ í…ŒìŠ¤íŠ¸ëŠ” viewë©´ view, modelì´ë©´ model ì‹ìœ¼ë¡œ í•˜ë‚˜ì˜ ê¸°ëŠ¥ì— ëŒ€í•´ì„œë§Œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<p>í•˜ì§€ë§Œ view í•˜ë‚˜ ë§Œìœ¼ë¡œë„ ëª¨ë¸, í¼, ë©”ì„œë“œ ë“± ì¤„ì¤„ì´ ì—°ê´€ë˜ì–´ í˜¸ì¶œë˜ì–´ì§‘ë‹ˆë‹¤.</p>

<p>ì´ëŸ¬í•œ ê²½ìš°, í…ŒìŠ¤íŠ¸ì— ëŒ€í•œ í™˜ê²½ì„ ì™„ì „íˆ ìµœì†Œí•œìœ¼ë¡œ êµ¬ì„±í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flavors/tests/test_api.py
</span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span> 
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">from</span> <span class="nn">flavors.models</span> <span class="kn">import</span> <span class="n">Flavor</span> 

<span class="k">class</span> <span class="nc">FlavorAPITests</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="n">Flavor</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'A Title'</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="s">'a-slug'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s">'flavors:flavor_object_api'</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> 
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> 
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span> 
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>ìµœì†Œí•œì˜ ë ˆì½”ë“œë¥¼ <code class="language-plaintext highlighter-rouge">setUp()</code> ë©”ì„œë“œë¥¼ ì´ìš©í•˜ì—¬ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤.</p>

<p>ë‹¤ìŒì€ REST API ê¸°ë°˜ì˜ í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flavors/tests/test_api.py
</span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">from</span> <span class="nn">flavors.models</span> <span class="kn">import</span> <span class="n">Flavor</span>

<span class="k">class</span> <span class="nc">DjangoRestFrameworkTests</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Flavor</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'title1'</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="s">'slug1'</span><span class="p">)</span>
        <span class="n">Flavor</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">'title2'</span><span class="p">,</span> <span class="n">slug</span><span class="o">=</span><span class="s">'slug2'</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">create_read_url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s">'flavors:flavor_rest_api'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">read_update_delete_url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s">'flavors:flavor_rest_api'</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">'slug'</span><span class="p">:</span><span class="s">'slug1'</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">test_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">create_read_url</span><span class="p">)</span>

        <span class="c1"># Are both titles in the content?
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">'title1'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">'title2'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">read_update_delete_url</span><span class="p">)</span> 
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">content</span> <span class="o">=</span> <span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'title'</span><span class="p">:</span> <span class="s">'title1'</span><span class="p">,</span> <span class="s">'slug'</span><span class="p">:</span> <span class="s">'slug1'</span><span class="p">,</span> <span class="s">'scoops_remaining'</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_create</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">post</span> <span class="o">=</span> <span class="p">{</span><span class="s">'title'</span><span class="p">:</span> <span class="s">'title3'</span><span class="p">,</span> <span class="s">'slug'</span><span class="p">:</span> <span class="s">'slug3'</span><span class="p">}</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">create_read_url</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span> 
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">content</span><span class="p">)</span> 
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
        <span class="n">content</span> <span class="o">=</span> <span class="p">{</span><span class="s">'id'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">'title'</span><span class="p">:</span> <span class="s">'title3'</span><span class="p">,</span> <span class="s">'slug'</span><span class="p">:</span> <span class="s">'slug3'</span><span class="p">,</span> <span class="s">'scoops_remaining'</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="n">Flavor</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">read_update_delete_url</span><span class="p">)</span> 
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">204</span><span class="p">)</span> 
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="n">Flavor</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="2432-for-views-when-possible-use-the-request-factory">24.3.2 For Views, When Possible Use the Request Factory</h3>

<p>ë·°ì— ëŒ€í•´ì„œëŠ” ê°€ëŠ¥í•˜ë©´ ìš”ì²­ íŒ©í„°ë¦¬ë¥¼ ì´ìš©í•˜ì</p>

<p><code class="language-plaintext highlighter-rouge">django.test.client.RequestFactory</code> ëŠ” ëª¨ë“  ë·°ì— ëŒ€í•´ í•´ë‹¹ ë·°ì˜ ì²« ë²ˆì§¸ ì¸ìë¡œ ì´ìš©í•  ìˆ˜ ìˆëŠ” ìš”ì²­ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ëŠ” ì¼ë°˜ Django í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ë³´ë‹¤ ë…ë¦½ëœ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.</p>

<p>ìƒì„±ëœ ìš”ì²­ì€ ì„¸ì…˜ê³¼ ì¸ì¦ì„ í¬í•¨í•œ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì§€ì›í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—, í…ŒìŠ¤íŠ¸ ì‘ì„±ì‹œ ì•½ê°„ì˜ ì¶”ê°€ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤. (<a href="[https://docs.djangoproject.com/en/3.2/topics/testing/advanced/](https://docs.djangoproject.com/en/3.2/topics/testing/advanced/)">Advanced testing topics</a> ì°¸ê³ )</p>

<p>ì‹±ê¸€ ë¯¸ë“¤ì›¨ì–´ í´ë˜ìŠ¤ë¡œ wrapëœ ë·°ë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²½ìš°, ë·°ê°€ ì„¸ì…˜ì„ í•„ìš”ë¡œ í•  ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">AnonymousUser</span>
<span class="kn">from</span> <span class="nn">django.contrib.sessions.middleware</span> <span class="kn">import</span> <span class="n">SessionMiddleware</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">RequestFactory</span>

<span class="kn">from</span> <span class="nn">.views</span> <span class="kn">import</span> <span class="n">cheese_flavors</span>

<span class="k">def</span> <span class="nf">add_middleware_to_request</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">middleware_class</span><span class="p">):</span>
    <span class="n">middleware</span> <span class="o">=</span> <span class="n">middleware_class</span><span class="p">()</span>
    <span class="n">middleware</span><span class="p">.</span><span class="n">process_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request</span>

<span class="k">def</span> <span class="nf">add_middleware_to_response</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">middleware_class</span><span class="p">):</span>
    <span class="n">middleware</span> <span class="o">=</span> <span class="n">middleware_class</span><span class="p">()</span>
    <span class="n">middleware</span><span class="p">.</span><span class="n">process_response</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">request</span>

<span class="k">class</span> <span class="nc">SavoryIceCreamTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ëª¨ë“  í…ŒìŠ¤íŠ¸ëŠ” request factoryì— ì ‘ê·¼í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">factory</span> <span class="o">=</span> <span class="n">RequestFactory</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_cheese_flavors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">request</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">factory</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/cheesy/broccoli/'</span><span class="p">)</span>
        <span class="n">request</span><span class="p">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">AnonymousUser</span><span class="p">()</span>
        <span class="c1"># ì„¸ì…˜ìœ¼ë¡œ request objectì— í‘œì‹ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
</span>        <span class="n">request</span> <span class="o">=</span> <span class="n">add_middleware_to_request</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">SessionMiddleware</span><span class="p">)</span>
        <span class="n">request</span><span class="p">.</span><span class="n">session</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
        <span class="c1"># requestë¥¼ ì²˜ë¦¬í•˜ê³  í…ŒìŠ¤íŠ¸ë¥¼ í•©ë‹ˆë‹¤.
</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">cheese_flavors</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">'bleah!'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="2433-dont-write-tests-that-have-to-be-tested">24.3.3 Donâ€™t Write Tests That Have to Be Tested</h3>

<p>í…ŒìŠ¤íŠ¸ê°€ í•„ìš”í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ì§€ ë§ì</p>

<p>í…ŒìŠ¤íŠ¸ëŠ” ê°€ëŠ¥í•œ í•œ ë‹¨ìˆœí•´ì•¼ í•©ë‹ˆë‹¤.</p>

<p>í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì•ˆì— ì½”ë“œ(í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ í•„ìš”ë¡œ í•˜ëŠ” ì½”ë“œ)ê°€ ë³µì¡í•˜ê±°ë‚˜ ì¶”ìƒì ì´ë¼ë©´ ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.</p>

<h3 id="2434-dont-repeat-yourself-doesnt-apply-to-writing-tests">24.3.4 Donâ€™t Repeat Yourself Doesnâ€™t Apply to Writing Tests</h3>

<p>ê°™ì€ ì¼ì„ ë°˜ë³µí•˜ì§€ ë§ë¼ëŠ” ë²•ì¹™ì€ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì“°ëŠ” ë°ëŠ” ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤</p>

<p>setUp() ì€ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì˜ ëª¨ë“  í…ŒìŠ¤íŠ¸ ë©”ì„œë“œì— ëŒ€í•´ ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•œ ë°ì´í„°ë¥¼ ë§Œë“­ë‹ˆë‹¤.</p>

<p>í•˜ì§€ë§Œ ë¹„ìŠ·í•˜ì§€ë§Œ ê° í…ŒìŠ¤íŠ¸ ë©”ì„œë“œë§ˆë‹¤ ê°ê¸° ë‹¤ë¥¸ ë°ì´í„°ê°€ í•„ìš”ë¡œ í•˜ê¸°ë„ í•©ë‹ˆë‹¤.</p>

<p>ì´ëŸ° ê²½ìš° ì¸ìë¥¼ ì¶”ê°€í•´ì„œ ëª¨ë“  ê²½ìš°ë¥¼ ë§Œì¡±ì‹œí‚¤ëŠ” í•˜ë‚˜ì˜ ë©”ì„œë“œë¥¼ ë§Œë“¤ê¸°ë„ í•˜ëŠ”ë° ì´ëŠ” ë‚˜ìœ ì‹ í˜¸ì…ë‹ˆë‹¤.</p>

<p>ì°¨ë¼ë¦¬ ë¹„ìŠ·í•œ ì½”ë“œë¥¼ ì—¬ëŸ¬ë²ˆ ë°˜ë³µí•´ì„œ ì‘ì„±í•˜ì„¸ìš”.(í…ŒìŠ¤íŠ¸ì— í•œí•´ ë³µë¶™ í—ˆìš©)</p>

<h3 id="2435-dont-rely-on-fixtures">24.3.5 Donâ€™t Rely on Fixtures</h3>

<p>í”½ìŠ¤ì²˜ë¥¼ ë„ˆë¬´ ì‹ ë¢°í•˜ì§€ ë§ì</p>

<p>í”„ë¡œì íŠ¸ì˜ ë°ì´í„°ê°€ ë°”ë€œì— ë”°ë¼ Fixtureë¥¼ ìœ ì§€í•˜ê¸°ê°€ ë§¤ìš° ì–´ë µìŠµë‹ˆë‹¤.</p>

<p>ìµœì‹  ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ì— ë§ì¶”ì–´ì„œ JSON íŒŒì¼ì„ ìˆ˜ì •í•˜ëŠ” ê²ƒ ìì²´ê°€ ì–´ë ¤ìš´ ì‘ì—…ì…ë‹ˆë‹¤.</p>

<p>(JSON íŒŒì¼ì´ ì†ìƒë˜ì—ˆê±°ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì œëŒ€ë¡œ ë°˜ì˜í•˜ê³  ìˆì§€ ì•ŠëŠ” ë“±)</p>

<p>ì´ëŒ„ Fixtureë³´ë‹¤ëŠ” ORMì— ì˜ì¡´í•˜ëŠ” ì½”ë“œë¥¼ ì œì‘í•˜ëŠ” ê²ƒì´ í›¨ì”¬ íš¨ìœ¨ì ì…ë‹ˆë‹¤.</p>

<p>ì„œë“œ íŒŒí‹° íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•ë„ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li>í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ìƒì„±í•´ ì£¼ëŠ” íŒ¨í‚¤ì§€
    <ul>
      <li>factory boy: ëª¨ë¸ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ìƒì„±í•´ ì£¼ëŠ” íŒ¨í‚¤ì§€</li>
      <li>faker: í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ìƒì„±í•˜ì§€ë§Œ ë¬´ì‘ìœ„ë¡œ ìƒì„±í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. factory boyì™€ í†µí•©í•˜ëŠ” ë°©ë²•ë„ ì œê³µí•©ë‹ˆë‹¤.
        <ul>
          <li><a href="[https://faker.readthedocs.io/en/master/](https://faker.readthedocs.io/en/master/)">Fakerâ€™s documentation</a></li>
          <li><a href="[https://faker.readthedocs.io/en/master/#how-to-use-with-factory-boy](https://faker.readthedocs.io/en/master/#how-to-use-with-factory-boy)">How to use with Factory Boy</a></li>
        </ul>
      </li>
      <li>model bakery: ëª¨ë¸ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ìƒì„±í•´ ì£¼ëŠ” íŒ¨í‚¤ì§€</li>
      <li>mock: Django ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ë¥¸ í™˜ê²½ì—ì„œë„ ì´ìš© ê°€ëŠ¥í•œ ì‹œìŠ¤í…œì˜ ì¼ë¶€ë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” mock ê°ì²´ë¥¼ ìƒì„±í•´ ì¤Œ</li>
    </ul>
  </li>
</ul>

<h3 id="2436-things-that-should-be-tested">24.3.6 Things That Should Be Tested</h3>

<p>í…ŒìŠ¤íŠ¸í•´ì•¼ í•  ëŒ€ìƒë“¤</p>

<p>ë¬¼ë¡  â€˜<strong>ì „ë¶€ ë‹¤</strong>â€™ í…ŒìŠ¤íŠ¸í•´ì•¼ í•  ëŒ€ìƒì…ë‹ˆë‹¤.</p>

<ul>
  <li>Views: ë°ì´í„°ì˜ ë·°ã…œ, ë°ì´í„° ë³€ê²½, ì»¤ìŠ¤í…€ í´ë˜ìŠ¤ì— ê¸°ë°˜ì„ ë‘” ë·° ë©”ì„œë“œ</li>
  <li>Models: ëª¨ë¸ì˜ ìƒì„±/ìˆ˜ì •/ì‚­ì œ, ëª¨ë¸ì˜ ë©”ì„œë“œ, ëª¨ë¸ ê´€ë¦¬ ë©”ì„œë“œ</li>
  <li>Forms: í¼ ë©”ì„œë“œ, <code class="language-plaintext highlighter-rouge">clear()</code> ë©”ì„œë“œ, ì»¤ìŠ¤í…€ í•„ë“œ</li>
  <li>Validators: ì§ì ‘ ì‘ì„±í•œ ì»¤ìŠ¤í…€ ìœ íš¨ì„± ê²€ì‚¬ê¸°ì— ëŒ€í•´ ì‹¬ë„ ê¹Šì€ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•´ì•¼ í•¨</li>
  <li>Signals: ì›ê²©ì—ì„œ ì‘ë™í•˜ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ë¥¼ í•˜ì§€ ì•Šìœ¼ë©´ ë¬´ì œê°€ ë˜ê¸° ì‰¬ì›€</li>
  <li>Filters: í•„í„°ë“¤ì€ ë³´í†µ 1~2ê°œì˜ ì¸ìë¥¼ ë„˜ê²¨ë°›ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ ì‘ì„±ì´ ì–´ë µì§€ ì•ŠìŒ</li>
  <li>Template Tags: í…œí”Œë¦¿ í…Œê·¸ëŠ” ë§‰ê°•í•œ ê¸°ëŠ¥ê³¼ í…œí”Œë¦¿ ì¼„í…ìŠ¤íŠ¸ë¥¼ í—ˆìš©í•˜ê¸° ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„±ì´ ë§¤ìš° ê¹Œë‹¤ë¡œì›€(ì¦‰, ê¼­ í…ŒìŠ¤íŠ¸í•´ì•¼ í•  ëŒ€ìƒì´ë¼ëŠ” ëœ»)</li>
  <li>ê¸°íƒ€: ì»¨í…ìŠ¤íŠ¸ í”„ë¡œì„¸ìŠ¤, ë¯¸ë“¤ì›¨ì–´, ì´ë©”ì¼, ê·¸ ì™¸ ëª¨ë“  ê²ƒ</li>
  <li>Failure: ìœ„ í…ŒìŠ¤íŠ¸ë“¤ ì¤‘ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•œë‹¤ë©´? ì‹œìŠ¤í…œ ì˜¤ë¥˜ í…ŒìŠ¤íŠ¸ëŠ” ì‹œìŠ¤í…œ ì„±ê³µ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ë§¤ìš° ì¤‘ìš”í•¨</li>
</ul>

<p>í…ŒìŠ¤íŠ¸ê°€ í•„ìš” ì—†ëŠ” ë¶€ë¶„ì€ Django core ë¶€ë¶„ê³¼ ì„œë“œ íŒŒí‹° íŒ¨ë¯¸ì§€ì—ì„œ ì´ë¯¸ í…ŒìŠ¤íŠ¸ë˜ì–´ ìˆëŠ” ë¶€ë¶„ ì •ë„</p>

<p>ê·¸ëŸ¬ë‚˜ Djangoì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” ê²ƒ ì™¸ì˜ ìƒˆë¡œìš´ í•„ë“œ íƒ€ì…ì„ ìƒì„±í•œë‹¤ë©´, í•´ë‹¹ í•„ë“œì— ì˜í•´ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ì‡ëŠ” ëª¨ë“  ë¶€ë¶„ì„ í…ŒìŠ¤íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<h3 id="2437-test-for-faulure">24.3.7 Test for Faulure</h3>

<p>í…ŒìŠ¤íŠ¸ì˜ ëª©ì ì€ í…ŒìŠ¤íŠ¸ì˜ ì‹¤íŒ¨ë¥¼ ì°¾ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>

<ul>
  <li>ì‹¤íŒ¨ë¥¼ ë¯¸ë¦¬ ì¸ì§€í•˜ì§€ ëª»í•œ ì¼€ì´ìŠ¤ì˜ ì˜ˆ
    <ul>
      <li>[uniittest -assertRaises]<strong>(</strong><a href="https://docs.python.org/2/library/unittest.html#unittest.TestCase.assertRaises">https://docs.python.org/2/library/unittest.html#unittest.TestCase.assertRaises</a>)</li>
      <li><a href="[https://docs.pytest.org/en/latest/how-to/assert.html#assertions-about-expected-exceptions](https://docs.pytest.org/en/latest/how-to/assert.html#assertions-about-expected-exceptions)">Assertions about expected exceptions</a></li>
    </ul>
  </li>
</ul>

<h3 id="2438-use-mock-to-keep-unit-tests-from-touching-the-world">24.3.8 Use Mock to Keep Unit Tests From Touching the World</h3>

<p>Mockì„ ì´ìš©í•˜ì—¬ ì‹¤ì œ ë°ì´í„°ì— ë¬¸ì œë¥¼ ì¼ìœ¼í‚¤ì§€ ì•Šê³  ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í•˜ê¸°</p>

<p>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìì²´ê°€ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜/ë©”ì„œë“œ ì™¸ì—ëŠ” í…ŒìŠ¤íŠ¸í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>

<p>ì¦‰, ì™¸ë¶€ API ì ‘ì†, ì´ë©”ì¼ ìˆ˜ì‹ , ì›¹í›…ê³¼ ê°™ì€ í…ŒìŠ¤íŠ¸ ì‘ì—…ì— í¬í•¨ë˜ì§€ ì•Šì€ ì‘ì—…ì„ ìˆ˜ì‹ í•˜ë©´ ì•ˆë©ë‹ˆë‹¤.</p>

<p>ì´ë¡œ ì¸í•´ ì™¸ë¶€ APIë¥¼ ì´ìš©í•˜ëŠ” ê¸°ëŠ¥ë“¤ì— ëŒ€í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” 2ê°€ì§€ ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìì²´ë¥¼ í†µí•© í…ŒìŠ¤íŠ¸ë¡œ ë³€ê²½í•œë‹¤.</li>
  <li>Mock ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•˜ì—¬ ì™¸ë¶€ APIì— ëŒ€í•œ ê°€ì§œ ì‘ë‹µì„ ë§Œë“ ë‹¤.</li>
</ul>

<p>Mock ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì™¸ë¶€ APIì— ëŒ€í•œ ìœ íš¨ì„±ì´ ì•„ë‹Œ ì½”ë“œì˜ ë¡œì§ì„ ê²€ì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">unittest</span> <span class="kn">import</span> <span class="n">mock</span><span class="p">,</span> <span class="n">TestCase</span> 
<span class="kn">import</span> <span class="nn">icecreamapi</span>

<span class="kn">from</span> <span class="nn">flavors.exceptions</span> <span class="kn">import</span> <span class="n">CantListFlavors</span> 
<span class="kn">from</span> <span class="nn">flavors.utils</span> <span class="kn">import</span> <span class="n">list_flavors_sorted</span>

<span class="k">class</span> <span class="nc">TestIceCreamSorting</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="c1"># Set up monkeypatch of icecreamapi.get_flavors()
</span>    <span class="o">@</span><span class="n">mock</span><span class="p">.</span><span class="n">patch</span><span class="p">.</span><span class="nb">object</span><span class="p">(</span><span class="n">icecreamapi</span><span class="p">,</span> <span class="s">'get_flavors'</span><span class="p">)</span> 
    <span class="k">def</span> <span class="nf">test_flavor_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_flavors</span><span class="p">):</span>
        <span class="c1"># icecreamapi.get_flavors()ê°€ ì •ë ¬ë˜ì§€ ì•Šì€ ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ë„ë¡ ì„¤ì •
</span>        <span class="n">get_flavors</span><span class="p">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">[</span><span class="s">'chocolate'</span><span class="p">,</span> <span class="s">'vanilla'</span><span class="p">,</span> <span class="s">'strawberry'</span><span class="p">,]</span>
        <span class="c1"># list_flavors_sorted()ê°€ icecreamapi.get_flavors()ë¥¼ í˜¸ì¶œ
</span>        <span class="c1"># monkeypatchedëŠ” í•­ìƒ ['chocolate', 'strawberry', 'vanilla', ]ë¥¼ ë°˜í™˜
</span>        <span class="c1"># ['chocolate', 'vanilla', 'strawberry',] ì•„ë‹Œê°€...?
</span>        <span class="c1"># list_flavors_sorted()ê°€ ìë™ìœ¼ë¡œ ì •ë ¬
</span>        <span class="n">flavors</span> <span class="o">=</span> <span class="n">list_flavors_sorted</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">flavors</span><span class="p">,</span>
            <span class="p">[</span><span class="s">'chocolate'</span><span class="p">,</span> <span class="s">'strawberry'</span><span class="p">,</span> <span class="s">'vanilla'</span><span class="p">,</span> <span class="p">]</span>
        <span class="p">)</span>
</code></pre></div></div>

<p>ì•„ì´ìŠ¤í¬ë¦¼ APIì— ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•  ê²½ìš° <code class="language-plaintext highlighter-rouge">list_flavors_sorted()</code> í•¨ìˆ˜ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">mock</span><span class="p">.</span><span class="n">patch</span><span class="p">.</span><span class="nb">object</span><span class="p">(</span><span class="n">icecreamapi</span><span class="p">,</span> <span class="s">'get_flavors'</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">test_flavor_sort_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get_flavors</span><span class="p">):</span>
	<span class="c1"># icecreamapi.get_flavors()ê°€ FlavorErrorë¥¼ ë°œìƒí•˜ë„ë¡ ì„¤ì •
</span>	<span class="n">get_flavors</span><span class="p">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">icecreamapi</span><span class="p">.</span><span class="n">FlavorError</span><span class="p">()</span>
	<span class="c1"># list_flavors_sorted()ê°€ icecreamapi.FlavorError()ë¥¼ ë°›ì•„ì„œ
</span>	<span class="c1"># CantListFlavors ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚´
</span>	<span class="k">with</span> <span class="bp">self</span><span class="p">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">CantListFlavors</span><span class="p">):</span>
	    <span class="n">list_flavors_sorted</span><span class="p">()</span>
</code></pre></div></div>

<p>python-requests ì—°ê²°ì— ë¬¸ì œê°€ ìƒê¸°ëŠ” 2ê°€ì§€ ê²½ìš°ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">mock</span><span class="p">.</span><span class="n">patch</span><span class="p">.</span><span class="nb">object</span><span class="p">(</span><span class="n">requests</span><span class="p">,</span> <span class="s">'get'</span><span class="p">)</span> 
<span class="k">def</span> <span class="nf">test_request_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get</span><span class="p">):</span>
	<span class="s">"""íƒ€ê²Ÿ ì‚¬ì´íŠ¸ì— ì ‘ê·¼ì´ ì•ˆ ë  ë•Œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰"""</span>
	<span class="n">get</span><span class="p">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">exception</span><span class="p">.</span><span class="nb">ConnectionError</span><span class="p">()</span> 

	<span class="k">with</span> <span class="bp">self</span><span class="p">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">CantListFlavors</span><span class="p">):</span>
		<span class="n">list_flavors_sorted</span><span class="p">()</span>

<span class="o">@</span><span class="n">mock</span><span class="p">.</span><span class="n">patch</span><span class="p">.</span><span class="nb">object</span><span class="p">(</span><span class="n">requests</span><span class="p">,</span> <span class="s">'get'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_request_failure_ssl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">get</span><span class="p">):</span>
	<span class="s">"""SSL ë¬¸ì œì— ëŒ€í•´ ì´ìŠˆê°€ ì—†ì„ ë•Œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰"""</span>
	<span class="n">get</span><span class="p">.</span><span class="n">side_effect</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">exception</span><span class="p">.</span><span class="n">SSLError</span><span class="p">()</span> 

	<span class="k">with</span> <span class="bp">self</span><span class="p">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">CantListFlavors</span><span class="p">):</span>
        <span class="n">list_flavors_sorted</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="2439-use-fancier-assertion-methods">24.3.9 Use Fancier Assertion Methods</h3>

<p>ì¢€ ë” ê³ ê¸‰ìŠ¤ëŸ¬ìš´ ë‹¨ì–¸ ë©”ì„œë“œ ì‚¬ìš©í•˜ê¸°</p>

<ul>
  <li>ìœ ìš©í•œ assertion ë©”ì„œë“œë“¤
    <ul>
      <li><a href="[https://docs.python.org/3/library/unittest.html#assert-methods](https://docs.python.org/3/library/unittest.html#assert-methods)">Python#assert-methods</a></li>
      <li><a href="[https://docs.djangoproject.com/en/3.2/topics/testing/tools/#assertions](https://docs.djangoproject.com/en/3.2/topics/testing/tools/#assertions)">Django#assertions</a></li>
    </ul>
  </li>
  <li>assertRaises</li>
  <li>assertRaisesMessage()</li>
  <li>assertCountEqual()</li>
  <li>assertDictEqual():</li>
  <li>assertFormError(): Form ì–‘ì‹ì„ í™•ì¸</li>
  <li>assertContains(): response.contentë¥¼ ì²´í¬í•˜ì—¬ status 200ì„ í™•ì¸</li>
  <li>assertHTMLEqual(): ë¹ˆ ì¹¸ì„ ë¬´ì‹œí•˜ê³  ë¹„êµ</li>
  <li>assertInHTML(): í° HTML í˜ì´ì§€ì—ì„œ html ì¡°ê°ì´ ìˆëŠ” í™•ì¸</li>
</ul>

<h3 id="24310-document-the-purpose-of-each-test">24.3.10 Document the Purpose of Each Test</h3>

<p>ê° í…ŒìŠ¤íŠ¸ ëª©ì ì€ ë¬¸ì„œí™”í•˜ë¼.</p>

<p>ë¬¸ì„œí™”ë˜ì§€ ì•Šì€ í…ŒìŠ¤íŠ¸ ì½”ë“œëŠ” í…ŒìŠ¤íŠ¸ê°€ ë¶ˆê°€ëŠ¥ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì•½ê°„ì˜ ë…ìŠ¤íŠ¸ë§ì€ í° ë„ì›€ì´ ë  ê²ƒì…ë‹ˆë‹¤.</p>

<p>í…ŒìŠ¤íŠ¸ëŠ” ë¬¸ì„œí™”í•¨ìœ¼ë¡œì¨ ë””ë²„ê·¸ê°€ ë¶ˆê°€ëŠ¥í•œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ë„ ìˆê³ ,</p>

<p>ë¬¸ì„œí™” ê³¼ì •ì—ì„œ ë¬¸ì œì ì„ ë°œê²¬í•  ìˆ˜ë„ ìˆê³ , ì ì–´ë„ ë¬¸ì„œëŠ” ë‚¨ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li><a href="https://hynek.me/articles/document-your-tests/">https://hynek.me/articles/document-your-tests/</a></li>
  <li><a href="https://interrogate.readthedocs.io/en/latest/">https://interrogate.readthedocs.io/en/latest/</a></li>
</ul>

<h2 id="244-what-about-integration-tests">24.4 What About Integration Tests?</h2>

<p>í†µí•© í…ŒìŠ¤íŠ¸ë€?</p>

<p>ê°œë³„ì ì¸ ì†Œí”„íŠ¸ì›¨ì–´ ëª¨ë“ˆì´ í•˜ë‚˜ì˜ ê·¸ë£¹ìœ¼ë¡œ ì¡°í•©ë˜ì–´ í…ŒìŠ¤íŠ¸ ë˜ëŠ” ê²ƒ</p>

<p>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ëë‚œ í›„ì— í–‰í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì´ìƒì ì…ë‹ˆë‹¤.</p>

<ul>
  <li>ex
    <ul>
      <li>ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë¸Œë¼ìš°ì €ì—ì„œ ì˜ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” Selenium í…ŒìŠ¤íŠ¸</li>
      <li>ì„œë“œíŒŒí‹° APIì— ëŒ€í•œ ê°€ìƒì˜ mock ì‘ë‹µì„ ëŒ€ì‹ í•˜ëŠ” ì‹¤ì œ í…ŒìŠ¤íŒ…
        <ul>
          <li>ê¹ƒí—™, PyPI APIë¥¼ ì´ìš©í•œ ì£¼ê¸°ì ì¸ í…ŒìŠ¤íŠ¸í•˜ëŠ” Django íŒ¨í‚¤ì§€ì´ë‹ˆ ê²½ìš° í•´ë‹¹ ì‹œìŠ¤í…œë“¤ê³¼ì˜ ì—°ë™ì´ ë¬¸ì œê°€ ì—†ëŠ”ì§€ì— ëŒ€í•œ ì‹¤ì œ í…ŒìŠ¤íŠ¸</li>
        </ul>
      </li>
      <li>ì™¸ë¶€ë¡œ ë‚˜ê°€ëŠ” ìš”ì²­ì— ëŒ€í•œ ìœ íš¨ì„±ì„ ê²€ì‚¬í•˜ê¸° ìœ„í•´ <a href="http://httpbin.org/">http://httpbin.org/</a> ì™€ ì—°ë™í•˜ëŠ” ê²½ìš°</li>
      <li>APIê°€ ê¸°ëŒ€ëŒ€ë¡œ ì˜ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ <a href="https://www.runscope.com/">https://www.runscope.com/</a> ë‚˜ <a href="https://www.postman.com/">https://www.postman.com/</a> ì„ ì´ìš©í•˜ëŠ” ê²½ìš°</li>
    </ul>
  </li>
  <li>í†µí•© í…ŒìŠ¤íŠ¸ì˜ ë¬¸ì œì 
    <ul>
      <li>í†µí•© í…ŒìŠ¤íŠ¸ ì„¸íŒ…ì— ë§ì€ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŒ</li>
      <li>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì™€ ë¹„êµí•˜ë©´ í…ŒìŠ¤íŠ¸ ì†ë„ê°€ ëŠë¦¼
        <ul>
          <li>ìµœì†Œ ë‹¨ìœ„ ì»´í¬ë„ŒíŠ¸(ë‹¨ìœ„í…ŒìŠ¤íŠ¸)ê°€ ì•„ë‹Œ ì‹œìŠ¤í…œ ì „ì²´ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ì´ê¸° ë•Œë¬¸</li>
        </ul>
      </li>
      <li>ì—ëŸ¬ê°€ ë°œìƒí•  ê²½ìš° ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë³´ë‹¤ ì—ëŸ¬ì˜ ì›ì¸ì„ ì°¾ê¸° ì–´ë ¤ì›€
        <ul>
          <li>ex. ë°ì´í„°ë² ì´ìŠ¤ ë ˆë²¨ì—ì„œ ë²Œì–´ì§„ ìœ ë‹ˆì½”ë“œ ë³€í™˜ ë¬¸ì œê°€ ë¸Œë¼ìš°ì €ì²˜ëŸ¼ ë³´ì¼ ìˆ˜ë„ ìˆìŒ</li>
        </ul>
      </li>
      <li>ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì— ë¹„í•´ ì¢€ ë” ë§ì€ ì£¼ì˜ê°€ ìš”êµ¬ë¨
        <ul>
          <li>ì»´í¬ë„ŒíŠ¸ë‚˜ ì‘ì€ ì„¸íŒ… ë³€ê²½ë§Œìœ¼ë¡œë„ í†µí•© í…ŒìŠ¤íŠ¸ ì „ì²´ì— ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆìŒ</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>ê·¸ëŸ¼ì—ë„ ë¶ˆêµ¬í•˜ê³  í†µí•© í…ŒìŠ¤íŠ¸ëŠ” ì¶©ë¶„íˆ ìœ ìš©í•©ë‹ˆë‹¤.</p>

<h2 id="245-continuous-integration">24.5 Continuous Integration</h2>

<p>ì§€ì†ì  í†µí•©</p>

<p>í¬ê¸°ì™€ ìƒê´€ì—†ì´ ìƒˆë¡œìš´ ì»¤ë°‹ì´ repoì— í‘¸ì‹œë  ë•Œë§ˆë‹¤ í”„ë¡œì íŠ¸ì˜ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” CI ì„œë²„ë¥¼ ì„¤ì •í•˜ê¸¸ ì¶”ì²œ</p>

<ul>
  <li><a href="">Chapter 34: Continuous Integration</a></li>
</ul>

<h2 id="246-who-cares-we-dont-have-time-for-tests">24.6 Who Cares? We Donâ€™t Have Time for Tests!</h2>

<p>ì•Œ ê²Œ ë­ëŒ? í…ŒìŠ¤íŠ¸í•  ì‹œê°„ì´ ì–´ë”” ìˆë‹¤ê³ !</p>

<p>í…ŒìŠ¤íŠ¸ë¥¼ ì„¸íŒ…í•˜ê³  ì‘ì„±í•˜ëŠ”ë°ëŠ” ì‹œê°„ì´ ì†Œìš”ë©ë‹ˆë‹¤.</p>

<p>í•˜ì§€ë§Œ ì´ëŸ° ìˆ˜ê³ ëŠ” ì¶”í›„ì— ë§ì€ ì‹œê°„ì„ ì„¸ì´ë¸Œ ì‹œì¼œì¤„ ê²ƒì…ë‹ˆë‹¤.</p>

<ul>
  <li>ex. Django í”„ë¡œì íŠ¸ì˜ ë²„ì „ ì—…ê·¸ë ˆì´ë“œ</li>
</ul>

<h2 id="247-the-game-of-test-coverage">24.7 The Game of Test Coverage</h2>

<p>í…ŒìŠ¤íŠ¸ ë²”ìœ„ ê²Œì„</p>

<p>ìµœëŒ€í•œ ë§ì€ ë²”ìœ„ì˜ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ëŠ” ê²Œì„ì„ í•´ ë³´ê¸¸ ì¶”ì²œí•©ë‹ˆë‹¤.</p>

<p>í…ŒìŠ¤íŠ¸ ë²”ìœ„ê°€ ë„“ì–´ì§€ëŠ” ê²ƒì´ ì´ê¸°ëŠ” ê²Œì„ì…ë‹ˆë‹¤.</p>

<h2 id="248-setting-up-the-test-coverage-game">24.8 Setting Up the Test Coverage Game</h2>

<p>í…ŒìŠ¤íŠ¸ ë²”ìœ„ ê²Œì„ ì…‹íŒ…í•˜ê¸°</p>

<p>í…ŒìŠ¤íŠ¸ ë²”ìœ„ëŠ” ê°œë°œì ìŠ¤ìŠ¤ë¡œì—ê²Œ ìê·¹ì„ ì£¼ê¸°ë„ í•˜ê³ ,</p>

<p>ê³ ê°, ê³ ìš©ì, íˆ¬ìì ë“±ì—ê²Œ í”„ë¡œì íŠ¸ ìƒíƒœë¥¼ ë³´ì—¬ì£¼ëŠ” ìœ ìš©í•œ ë„êµ¬ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>í…ŒìŠ¤íŠ¸ ë²”ìœ„ì— ì„œë“œ íŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì œì™¸í•˜ì„¸ìš”.</p>

<p>ëŒ€ë¶€ë¶„ì˜ ì„œë“œ íŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì€ ì´ë¯¸ í…ŒìŠ¤íŠ¸ëœ ê²°ê³¼ë¬¼ë“¤ì…ë‹ˆë‹¤.</p>

<h3 id="2481-step1-start-writing-tests">24.8.1 Step1: Start Writing Tests</h3>

<p>í…ŒìŠ¤íŠ¸ ì‘ì„± ì‹œì‘í•˜ê¸°</p>

<h3 id="2482-step2-run-tests-and-generate-coverage-report">24.8.2 Step2: Run Tests and Generate Coverage Report</h3>

<p>í…ŒìŠ¤íŠ¸ ì‹¤í–‰í•˜ê¸° ê·¸ë¦¬ê³  ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸ ì‘ì„±í•˜ê¸°</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">coverage</span> <span class="n">run</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">test</span> <span class="o">--</span><span class="n">settings</span><span class="o">=</span><span class="n">twoscoops</span><span class="p">.</span><span class="n">settings</span><span class="p">.</span><span class="n">test</span>

<span class="n">Creating</span> <span class="n">test</span> <span class="n">database</span> <span class="k">for</span> <span class="n">alias</span> <span class="s">"default"</span><span class="p">...</span>
<span class="p">..</span>
<span class="o">-----------------------------------------------</span>
<span class="n">Ran</span> <span class="mi">2</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.008</span><span class="n">s</span>

<span class="n">OK</span>
   <span class="n">Destroying</span> <span class="n">test</span> <span class="n">database</span> <span class="k">for</span> <span class="n">alias</span> <span class="s">"default"</span><span class="p">...</span>
</code></pre></div></div>

<h3 id="2483-step3-generate-the-report">24.8.3 Step3: Generate the Report!</h3>

<p>ë¦¬í¬íŠ¸ ìƒì„±í•˜ê¸°</p>

<p>coverage.pyëŠ” HTML ë³´ê³ ì„œë¥¼ ìƒì„±í•´ì£¼ëŠ”ë°, í¼ì„¼íŠ¸ë¡œ ì»¤ë²„ë¦¬ì§€ë¥¼ ì œê³µí•˜ê³ , í…ŒìŠ¤íŠ¸ë˜ì§€ ì•Šì€ ì¥ì†Œê¹Œì§€ ë³´ì—¬ì¤ë‹ˆë‹¤.</p>

<p>í”„ë¡œì íŠ¸ì˜ ë£¨íŠ¸ì—ì„œ ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="n">coverage</span> <span class="n">html</span> <span class="o">--</span><span class="n">omit</span><span class="o">=</span><span class="s">"admin.py"</span>
</code></pre></div></div>

<p>ì‹¤í–‰í›„ì— htmlcov/ ë¼ëŠ” ë””ë ‰í„°ë¦¬ê°€ ìƒì„±ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆëŠ”ë°, index.htmlë¥¼ ì‹¤í–‰í•˜ë©´ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì—¬ëŸ¬ ëª¨ë“ˆë“¤ì„ í´ë¦­í•´ ë³´ë©´ ë¹¨ê°„ìƒ‰ë“¤ì´ ìˆëŠ”ë°, ì´ëŠ” ì¢‹ì§€ ì•Šë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.</p>

<p>ì»¤ë²„ë¦¬ì§€ê°€ ë‚®ë‹¤ë©´ ê³µê°œì ìœ¼ë¡œ ì»¤ë²„ë¦¬ì§€ë¥¼ ë†’ì´ëŠ” ì‘ì—…ì¤‘ì´ë¼ê³  ì„ ì–¸í•©ì‹œë‹¤. ê·¸ëŸ¼ ë§ì€ ê°œë°œìë“¤ì—ê²Œì„œ ì›ê¸°ì˜¥ì„ ëª¨ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h2 id="249-playing-the-game-of-test-coverage">24.9 Playing the Game of Test Coverage</h2>

<p>í…ŒìŠ¤íŠ¸ ë²”ìœ„ ê²Œì„ ì‹œì‘í•˜ê¸°</p>

<p>ì´ ê²Œì„ì€ í•œ ê°€ì§€ ë£°ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.</p>

<p><strong>â€œí…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ë¥¼ ë‚®ì¶”ëŠ” ê·¸ ì–´ë–¤ ì»¤ë°‹ë„ í—ˆìš©í•˜ì§€ ì•Šê¸°â€</strong></p>

<p>ì»¤ë²„ë¦¬ì§€ ìˆ«ìê°€ ëŠ˜ì–´ë‚œë‹¤ëŠ” ê²ƒì€ ì˜ë¯¸ ì—†ëŠ” ê°€ì§œ í…ŒìŠ¤íŠ¸ë¥¼ ë„£ì§€ ì•Šê³  ìˆë‹¤ëŠ” ê²ƒê³¼ ë™ì‹œì— í”„ë¡œì íŠ¸ì˜ í’ˆì§ˆì´ ìƒìŠ¹í•˜ê³  ì‡ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>

<h2 id="2410-alternatives-to-unittest">24.10 Alternatives to unittest</h2>

<p>unittest ì˜ ëŒ€ì•ˆ</p>

<ul>
  <li><a href="https://pypi.org/project/pytest-django/">https://pypi.org/project/pytest-django/</a></li>
</ul>

<p>ì•½ê°„ì˜ ì¶”ê°€ì ì¸ ì…‹ì—…ìœ¼ë¡œ unittest ê¸°ë°˜ì˜ í…ŒìŠ¤íŠ¸ë¿ë§Œ ì•„ë‹ˆë¼ ì–´ë–¤ í•¨ìˆ˜(í´ë˜ìŠ¤, ë””ë ‰í„°ë¦¬, ëª¨ë“ˆ í¬í•¨)ë“ ì§€  <code class="language-plaintext highlighter-rouge">test_</code>  ê°€ ë¶™ì€ ê²ƒì€ ëª¨ë‘ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test_models.py
</span><span class="kn">from</span> <span class="nn">pytest</span> <span class="kn">import</span> <span class="n">raises</span>
<span class="kn">from</span> <span class="nn">cones.models</span> <span class="kn">import</span> <span class="n">Cone</span>

<span class="k">def</span> <span class="nf">test_good_choice</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">Cone</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="nb">filter</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s">'sugar'</span><span class="p">).</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">test_bad_cone_choice</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">raises</span><span class="p">(</span><span class="n">Cone</span><span class="p">.</span><span class="n">DoesNotExist</span><span class="p">):</span>
        <span class="n">Cone</span><span class="p">.</span><span class="n">objects</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s">'spaghetti'</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">nose.tools.raises</code> ë°ì½”ë ˆì´ì…˜ìœ¼ë¡œ noseë¥¼ ì´ìš©í•œ ë¹„ìŠ·í•œ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì´ëŸ° í•¨ìˆ˜ ê¸°ë°˜ì˜ ë‹¨ìˆœí™”ëœ í…ŒìŠ¤íŠ¸ëŠ” í…ŒìŠ¤íŠ¸ê°„ ìƒì†ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤ëŠ” ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤.</p>

<p>í”„ë¡œì íŠ¸ì˜ ë§ì€ í…ŒìŠ¤íŠ¸ë“¤ì´ ë¹„ìŠ·í•œ ë™ì‘ì„ í•˜ëŠ” ê²½ìš° ì´ëŸ° ë°©ì‹ì€ ì§€ì–‘í•´ì•¼ í•©ë‹ˆë‹¤.</p>
:ET