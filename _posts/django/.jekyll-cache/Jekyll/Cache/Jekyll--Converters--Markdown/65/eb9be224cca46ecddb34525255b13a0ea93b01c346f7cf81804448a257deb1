I"Ê<<blockquote>
  <p><a href="https://www.feldroy.com/books/two-scoops-of-django-3-x">Two Scoops of Django 3.x</a></p>
</blockquote>

<hr />

<ul>
  <li>Django í…œí”Œë¦¿ ì‹œìŠ¤í…œì—ì„œ ì§€ì›í•˜ëŠ” ë°±ì—”ë“œ
    <ul>
      <li>Django Template Language(DTL)</li>
      <li>Jinja2</li>
    </ul>
  </li>
</ul>

<h2 id="161-whats-the-syntactical-difference">16.1 Whatâ€™s the Syntactical Difference?</h2>

<table>
  <thead>
    <tr>
      <th>Subject</th>
      <th>DTL</th>
      <th>Jinja2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ë©”ì„œë“œ í˜¸ì¶œ</td>
      <td><code class="language-plaintext highlighter-rouge">{{ user.get_favorites }}</code></td>
      <td><code class="language-plaintext highlighter-rouge">{{ user.get_favorites() }}</code></td>
    </tr>
    <tr>
      <td>ì¸ì í•„í„°</td>
      <td><code class="language-plaintext highlighter-rouge">{{ toppings|join:', ' }}</code></td>
      <td><code class="language-plaintext highlighter-rouge">{{ toppings|join(', ') }}</code></td>
    </tr>
    <tr>
      <td>ì¸ìê°€ ì—†ëŠ” ë£¨í”„</td>
      <td><code class="language-plaintext highlighter-rouge">{% empty %}</code></td>
      <td><code class="language-plaintext highlighter-rouge">{% else %}</code></td>
    </tr>
    <tr>
      <td>ë£¨í”„ ë³€ìˆ˜</td>
      <td><code class="language-plaintext highlighter-rouge">{{ forloop }}</code></td>
      <td><code class="language-plaintext highlighter-rouge">{{ loop }}</code></td>
    </tr>
    <tr>
      <td>ì‚¬ì´í´</td>
      <td><code class="language-plaintext highlighter-rouge">{% cycle 'odd' 'even' %}</code></td>
      <td><code class="language-plaintext highlighter-rouge">{{ loop.cycle('odd, even' ) }}</code></td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="162-should-i-switch">16.2 Should I Switch?</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">settings.TEMPLATES</code>ë¥¼ ì„¤ì •í•˜ì—¬ íŠ¹ì • ë””ë ‰í„°ë¦¬ë§ˆë‹¤ DTL, Jinja2ë¥¼ ê°ê° ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    <ul>
      <li>DTL: ì‚¬ì´íŠ¸ì˜ ëŒ€ë¶€ë¶„ì„ ë Œë”ë§</li>
      <li>Jinja2: ë§ì€ ì»¨í…ì¸ ë¥¼ ë‹´ê³  ìˆëŠ” í˜ì´ì§€</li>
    </ul>
  </li>
</ul>

<h3 id="1621-advantages-of-dtl">16.2.1 Advantages of DTL</h3>

<ul>
  <li>ì´ë¯¸ Djangoì— DTLì´ í¬í•¨ë˜ì–´ ìˆìŒ
    <ul>
      <li>Djangoì˜ ê³µì‹ë¬¸ì„œì— ë¬¸ì„œí™” ë˜ì–´ ìˆìŒ</li>
    </ul>
  </li>
  <li>ëŒ€ë¶€ë¶„ì˜ ì„œë“œ íŒŒí‹° ì¥ê³  íŒ¨í‚¤ì§€ì—ì„œ DTLì„ ì´ìš©
    <ul>
      <li>Jinja2ë¡œ ë³€ê²½í•˜ë ¤ë©´ ì¶”ê°€ì‘ì—…ì´ í•„ìš”</li>
    </ul>
  </li>
  <li>DTL ì½”ë“œë“¤ì„ Jinja2ë¡œ ë³€ê²½í•˜ëŠ”ê±´ ì‘ì€ ì¼ì´ ì•„ë‹˜</li>
</ul>

<h3 id="1622-advantages-of-jinja2">16.2.2 Advantages of Jinja2</h3>

<ul>
  <li>Djangoì™€ ë…ë¦½ì ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥</li>
  <li>Python ë¬¸ë²•ì— ì¢€ ë” ê°€ê¹Œì›€</li>
  <li>Jinja2ê°€ ì¢€ ë” ëª…ì‹œì ì´ê³  ëª…í™•í•¨
    <ul>
      <li>ex. í…œí”Œë¦¿ìƒì—ì„œ í•¨ìˆ˜ í˜¸ì¶œì‹œ ê´„í˜¸ë¥¼ ì‚¬ìš©</li>
    </ul>
  </li>
  <li>ë¡œì§ìƒì˜ ì„ì˜ì  ì œì•½ì´ ëœí•¨
    <ul>
      <li>ex. Jinja2ì—ì„œëŠ” í•„í„°ì— ë¬´í•œëŒ€ì˜ ì¸ì‚¬ ì‚¬ìš©ê°€ëŠ¥ / DTLì€ í•œ ê°œë§Œ ê°€ëŠ¥</li>
    </ul>
  </li>
  <li>ë²¤ì¹˜ë§ˆí¬ ê²°ê³¼ Jinja2ê°€ ì¼ë°˜ì ìœ¼ë¡œ ë” ë¹ ë¦„
    <ul>
      <li>í…œí”Œë¦¿ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™” ì´ìŠˆë³´ë‹¤ ì‹¬ê°í•œ ì„±ëŠ¥ìƒì˜ ë³‘ëª© ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ
        <ul>
          <li><a href="">chap24. Finding and Reducing Bottlenecks</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="1623-which-one-wins">16.2.3 Which One Wins?</h3>

<ul>
  <li>Djangoë¥¼ ì²˜ìŒ ì ‘í–ˆë‹¤ë©´ DTL</li>
  <li>ì´ë¯¸ ë§ì´ ì§„í–‰ëœ í”„ë¡œì íŠ¸ë¼ë©´, íŠ¹ë³„íˆ ì„±ëŠ¥ í–¥ìƒì„ í•„ìš”í•œ ëª‡ í˜ì´ì§€ë¥¼ ì œì™¸í•˜ê³ ëŠ” DTLì„ ìœ ì§€</li>
  <li>Django ê²½í—˜ì´ ì–´ëŠ ì •ë„ ìˆë‹¤ë©´ DTLê³¼ Jinja2 ëª¨ë‘ ê²½í—˜í•˜ê³  ê²°ì •í•  ìˆ˜ ìˆìŒ</li>
  <li>ì—¬ëŸ¬ í…œí”Œë¦¿ ì–¸ì–´ë¥¼ í˜¼í•©í•˜ì—¬ ì‚¬ìš©í•˜ë©´ ì •ì‹ ì  ë¶€í•˜ê°€ ê°€ì¤‘ë¨. í•˜ë‚˜ë§Œ ì„ íƒí•˜ì—¬ ì‚¬ìš©í•˜ì</li>
</ul>

<h2 id="163-considerations-when-using-jinja2-with-django">16.3 Considerations When Using Jinja2 With Django</h2>

<h3 id="1631-csrf-and-jinja2">16.3.1 CSRF and Jinja2</h3>

<ul>
  <li>Jinja2 í…œí”Œë¦¿ì— CSRFë¥¼ í¬í•¨ì‹œí‚¤ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"display:none"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"csrfmiddlewaretoken"</span> <span class="na">value=</span><span class="s">"{{csrf_token}}"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<h3 id="1632-using-template-tags-in-jinja2-templates">16.3.2 Using Template Tags in Jinja2 Templates</h3>

<ul>
  <li>Django ìŠ¤íƒ€ì¼ì˜ í…œí”Œë¦¿ íƒœê·¸ëŠ” Jinja2ì—ì„œ ë¶ˆê°€ëŠ¥
    <ul>
      <li>íŠ¹ì • í…œí”Œë¦¿ íƒœê·¸ ê¸°ëŠ¥ì´ í•„ìš”í•˜ë‹¤ë©´ ë‹¤ìŒ ê¸°ìˆ ì„ ì´ìš©í•˜ì—¬ ë³€í™˜í•´ì•¼ í•¨
        <ul>
          <li>í•´ë‹¹ ê¸°ëŠ¥ì„ í•¨ìˆ˜ë¡œ ë³€í™˜</li>
          <li>Jinja2 extension ì„ ì‘ì„± <a href="[https://jinja.palletsprojects.com/en/latest/extensions/](https://jinja.palletsprojects.com/en/latest/extensions/)">jinja2 doc</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="1633-using-django-style-template-filters-in-jinja2-templates">16.3.3 Using Django-Style Template Filters in Jinja2 Templates</h3>

<ul>
  <li>í•„í„°ë“¤ì€ ê¸°ë³¸ì ìœ¼ë¡œ í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì—, ì»¤ìŠ¤í…€ Jinja2 í™˜ê²½ì— í…œí”Œë¦¿ í•„í„°ë“¤ì„ ì‰½ê²Œ í¬í•¨ì‹œí‚¬ ìˆ˜ ìˆìŒ</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># core/jinja2.py
</span><span class="kn">from</span> <span class="nn">django.contrib.staticfiles.storage</span> <span class="kn">import</span> <span class="n">staticfiles_storage</span>
<span class="kn">from</span> <span class="nn">django.template</span> <span class="kn">import</span> <span class="n">defaultfilters</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Environment</span>

<span class="k">def</span> <span class="nf">environment</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">):</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="n">env</span><span class="p">.</span><span class="nb">globals</span><span class="p">.</span><span class="n">update</span><span class="p">({</span>
        <span class="s">'static'</span><span class="p">:</span> <span class="n">staticfiles_storage</span><span class="p">.</span><span class="n">url</span><span class="p">,</span>
        <span class="s">'url'</span><span class="p">:</span> <span class="n">reverse</span><span class="p">,</span>
        <span class="s">'dj'</span><span class="p">:</span> <span class="n">defaultfilters</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="n">env</span>
</code></pre></div></div>

<ul>
  <li>Django í…œí”Œë¦¿ í•„í„°ë¥¼ Jinja2 í…œí”Œë¦¿ì—ì„œ í•¨ìˆ˜ë¡œ ì´ìš©í•˜ëŠ” ì˜ˆ</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">table</span><span class="o">&gt;&lt;</span><span class="n">tbody</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="n">purchase</span> <span class="ow">in</span> <span class="n">purchase_list</span> <span class="o">%</span><span class="p">}</span>
  <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">"{{ url('purchase:detail', pk=purchase.pk) }}"</span><span class="o">&gt;</span>
      <span class="p">{{</span> <span class="n">purchase</span><span class="p">.</span><span class="n">title</span> <span class="p">}}</span>
    <span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
  <span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">dj</span><span class="p">.</span><span class="n">date</span><span class="p">(</span><span class="n">purchase</span><span class="p">.</span><span class="n">created</span><span class="p">,</span> <span class="s">'SHORT_DATE_FORMAT'</span><span class="p">)</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">tr</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">dj</span><span class="p">.</span><span class="n">floatformat</span><span class="p">(</span><span class="n">purchase</span><span class="p">.</span><span class="n">amount</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">tr</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endfor</span> <span class="o">%</span><span class="p">}</span>
<span class="o">&lt;/</span><span class="n">tbody</span><span class="o">&gt;&lt;/</span><span class="n">table</span><span class="o">&gt;</span>
</code></pre></div></div>

<ul>
  <li>ë·°ì—ì„œ ì†ì„±ìœ¼ë¡œ Django í…œí”Œë¦¿ í•„í„°ë¥¼ ì¶”ê°€í•˜ê¸° ìœ„í•œ ë¯¹ìŠ¤ì¸ì„ ìƒì„±</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># core/mixins.py
</span><span class="kn">from</span> <span class="nn">django.template</span> <span class="kn">import</span> <span class="n">defaultfilters</span>

<span class="k">class</span> <span class="nc">DjFilterMixin</span><span class="p">:</span>
    <span class="n">dj</span> <span class="o">=</span> <span class="n">defaultfilters</span>
</code></pre></div></div>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;table&gt;&lt;tbody&gt;</span>
{% for purchase in purchase_list %}
  <span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{{ url('purchase:detail', pk=purchase.pk) }}"</span><span class="nt">&gt;</span>
      {{ purchase.title }}
    <span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/tr&gt;</span>
  <span class="c">&lt;!-- Call the django.template.defaultfilters functions from the ô°â†’ view--&gt;</span>
  <span class="nt">&lt;tr&gt;</span>{{ view.dj.date(purchase.created, 'SHORT_DATE_FORMAT') ô°â†’ }}<span class="nt">&lt;/tr&gt;</span>
  <span class="nt">&lt;tr&gt;</span>{{ view.dj.floatformat(purchase.amount, 2) }}<span class="nt">&lt;/tr&gt;</span> {% endfor %}
<span class="nt">&lt;/tbody&gt;&lt;/table&gt;</span>
</code></pre></div></div>

<blockquote>
  <p><strong>Jinja2 í…œí”Œë¦¿ê³¼ í•¨ê»˜ ì»¨í…ìŠ¤íŠ¸ í”„ë¡œì„¸ì„œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ê¶Œì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</strong> <a href="[https://docs.djangoproject.com/en/3.2/topics/templates/#django.template.backends.jinja2.Jinja2](https://docs.djangoproject.com/en/3.2/topics/templates/#django.template.backends.jinja2.Jinja2)">Django doc</a> ì»¨í…ìŠ¤íŠ¸ í”„ë¡œì„¸ì„œëŠ” Django í…œí”Œë¦¿ì´ ì¸ìˆ˜ê°€ ìˆëŠ” í˜¸ì¶œ í•¨ìˆ˜ë¥¼ ì§€ì›í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— Django í…œí”Œë¦¿ì— ìœ ìš©í•©ë‹ˆë‹¤.Â Jinja2ëŠ” ê·¸ëŸ° ì œí•œì´ ì—†ê¸° ë•Œë¬¸ì— í…œí”Œë¦¿ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì „ì—­ ë³€ìˆ˜ì— ì»¨í…ìŠ¤íŠ¸ í”„ë¡œì„¸ì„œë¡œ ì‚¬ìš©í•  í•¨ìˆ˜ë¥¼ ì•„ë˜ì™€ ê°™ì´ ë„£ëŠ” ê²ƒì„ ê¶Œì¥Â <strong><code class="language-plaintext highlighter-rouge">jinja2.Environment</code></strong>í•©ë‹ˆë‹¤.Â ê·¸ëŸ° ë‹¤ìŒ í…œí”Œë¦¿ì—ì„œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

</blockquote>

<h3 id="1634-the-jinja2-environment-object-should-be-considered-static">16.3.4 The Jinja2 Environment Object Should Be Considered Static</h3>

<p>15.1ì—ì„œ Jinja2ì˜ ì½”ì–´ ì»´í¬ë„ŒíŠ¸ <code class="language-plaintext highlighter-rouge">jinja2.Environment</code> í´ë˜ìŠ¤ë¥¼ ì´ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ ê°ì²´ëŠ” Jinja2ê°€ ì„¤ì •ë“¤ê³¼ í•„í„°, í…ŒìŠ¤íŠ¸, ì „ì—­ê°’ ë“±ì„ ê³µìœ í•˜ëŠ” ê³µê°„ì…ë‹ˆë‹¤. í”„ë¡œì íŠ¸ì—ì„œ ì²« í…œí”Œë¦¿ì´ ë¡œë“œë  ë•Œ ì´ í´ë˜ìŠ¤ì˜ ì •ì  ê°ì²´ì²˜ëŸ¼ ì‹¤ì²´í™”í•˜ì—¬ ì´ìš©í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># core/jinja2.py
</span><span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Environment</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">environment</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">):</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="n">env</span><span class="p">.</span><span class="nb">globals</span><span class="p">.</span><span class="n">update</span><span class="p">({</span>
        <span class="c1"># ì˜¤ë¡œì§€ ì²« í…œí”Œë¦¿ì´ ë¡œë“œë  ë•Œë§Œ ì‹¤í–‰.
</span>        <span class="c1"># ë‹¤ìŒ 3 í™”ë©´ì—ì„œëŠ” ê°™ì€ ë²ˆí˜¸ë¥¼ ë³´ì—¬ ì¤Œ
</span>        <span class="c1"># {{ random_once }} {{ random_once }} {{ random_once }}
</span>        <span class="s">'random_once'</span><span class="p">:</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="c1"># í…œí”Œë¦¿ìƒì˜ í•¨ìˆ˜ì²˜ëŸ¼ ë°˜ë³µë˜ì–´ í˜¸ì¶œ
</span>        <span class="c1"># ë§¤ë²ˆ í˜¸ì¶œì—ì„œ ê° ë‹¤ë¥¸ ëœì  ë²ˆí˜¸ë¥¼ ë°˜í™˜
</span>        <span class="c1"># {{ random() }} {{ random() }} {{ random() }}
</span>        <span class="s">'random'</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="p">})</span>
    <span class="k">return</span> <span class="n">env</span>
</code></pre></div></div>

<blockquote>
  <p><strong>ì¼ë‹¨ ì‹¤ì²´í™”ë˜ê³  ë‚œ í›„ì—ëŠ” jinja.Environmentë¥¼ ë³€í˜•í•˜ì§€ ë§ì.</strong> â€œì²« í…œí”Œë¦¿ì´ ë¡œë“œëœ í›„ í™˜ê²½ ì„¤ì •ì„ ë³€ê²½í•˜ëŠ” ê²ƒì€ ì˜ˆìƒì¹˜ ëª»í•œ ìƒí™©ê³¼ ì•Œ ìˆ˜ ì—†ëŠ” ê²°ê³¼ë¥¼ ì´ˆë˜í•  ê²ƒì´ë‹¤.â€ - Jinja2 API Doc</p>

</blockquote>

<h2 id="164-resources">16.4 Resources</h2>

<ul>
  <li><a href="[https://jinja.palletsprojects.com/en/3.0.x/](https://jinja.palletsprojects.com/en/3.0.x/)">jinja</a></li>
  <li><a href="[https://docs.djangoproject.com/en/3.2/topics/templates/#django.template.backends.jinja2.Jinja2](https://docs.djangoproject.com/en/3.2/topics/templates/#django.template.backends.jinja2.Jinja2)">django doc</a></li>
</ul>

:ET