---
layout: post
section-type: post
title: HTTP-part1.HTTP 웹의 기초 - chap2. URL과 리소스
category: http
tags: [ 'http' ]
---

Chap2에서 다루는 내용

- URL 문법, 여러 URI 컴포넌트가 어떤 의미를 가지며 무엇을 수행하는지.
- 여러 웹 클라이언트가 지원하는 상대 URL과 확장 URL 같은 단축 URL에 대해서.
- URL의 인코딩과 문자 규칙.
- 여러 인터넷 정보 시스템에 적용되는 공통 URL 스킴.
- 기존 이름은 유지하면서 객체들을 다른 장소로 옮기는 것을 가능하게 해주는 URN(Uniform Resource Name)을 포함한 URL의 미래

## 2.1 인터넷의 리소스 탐색하기
URL은 HTTP 프로토콜이 아닌 다른 가용한 프로토콜을 사용할 수도 있다.

ex.  
mailto:makingfunk0@gmail.com 는 이메일을 가리킨다.  
ftp://czarcie.com/pub/abc.xls 는 FTP 서버에 올라가 있는 파일을 가리킨다.  


URL은 '스킴://서버위치/경로' 구조로 이루어져 있다.

### 2.1.1 URL이 있기 전 암흑의 시대
URL은 브라우저가 더 영리하게 리소스에 접근하고 그것을 다루게 하여 인터넷 사용을 단순화 시킨다. 애플리케이션은 URL을 사용하여 정보에 쉽게 접근할 수 있다.

## 2.2 URL 문법

`<스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<플래그먼트>`  
이 중 가장 중요한 컴포넌트는 **스킴, 호스트, 경로** 이다.

컴포넌트 | 설명 | 기본값
---|---|---
스킴 | 리소스를 가져오려면 어떤 프로토콜을 사용하여 서버에 접근해야 하는지 가리킨다. | 없음
사용자 이름 | 몇몇 스킴은 리소스에 접근하기 위해 사용자 이름이 필요하다. | anonymous
비밀번호 | 사용자의 비밀번호. 사용자 이름에 콜론(:)으로 이어서 기술한다. | 이메일 주소
호스트 | 리소스를 호스팅하는 서버의 호스트 명이나 IP 주소. | 없음
포트 | 리소스를 호스팅하는 서버가 열어 놓는 포트번호. | 스킴에 따라 다름
경로 | 이전 컴포넌트와 슬러시(/)로 구분되어 있으며, 서버 내 리소스가 어디 있는지를 가리킨다. | 없음
파라미터 | 특정 스킴들에서 입력 파라미터를 기술하는 용도. 파라미터는 이름/값을 쌍으로 가진다. 세미콜론(;)으로 구분하여 기술한다. | 없음
질의 | 스킴에서 애플리케이션(데이터베이스, 게시판, 검색엔진 등)에 파라미터를 전달하는데 사용. URL의 끝에 ?으로 구분한다. | 없음
프래그먼트 | 리소스의 조각이나 일부분을 가리키는 이름. 프레그먼트 필드는 서버에 전달되지 않는다. URL의 끝에서 '#' 문자로 구분한다. | 없음

### 2.2.1 스킴: 사용할 프로토콜
스킴은 URL을 해석하는 애플리케이션이 어떤 프로토콜을 사용하여 리소스를 요청해야 하는지 알려준다.

### 2.2.2 호스트와 포트
호스트 컴포넌트는 접근하려 하는 리소스를 가지고 있는 인터넷상의 호스트 장비를 가리킨다.  
포트 컴포넌트는 서버가 열어놓은 네트워트 포트를 가리킨다. 내부적으로 TCP 프로토콜을 사용하는 HTTP는 80이 기본 포트이다.

### 2.2.3 사용자 이름과 비밀번호
FTP 같은 서버는 사용자 이름과 비밀번호가 있어야 데이터에 접근이 가능하다.

### 2.2.4 경로
URL의 경로 컴포넌트는 리소스가 서버의 어디에 있는지 알려준다.

### 2.2.5 파라미터
URL을 사용하는 애플리케이션이 리소스에 접근하려면 프로토콜 파라미터가 필요하다. 예를 들어 사용자가 바이너리 이미지를 요청했지만 텍스트 형식으로 전송된다면 제대로 사용할 수 없기 때문에 정확한 요청을 위해 필요한 입력 파라미터를 사용한다. 이 컴포넌트는 이름/값 쌍의 리스트로 URL 나머지 부분들로부터 세미클론(;)으로 구분하여 URL에 기술한다.

ex. ftp://abc.com/pub/gnu;type=d  
이름이 'type'이고, 값이 'd'인 한 대의 파라미터를 전달한다.

### 2.2.6 질의 문자열
데이터베이스 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해 질의를 받을 수 있다.  
특정 문자들을 제외하고는 질의 컴포넌트 포맷에 제약사항은 없다. 편의상 '&'로 나뉜 '이름=값' 쌍 형식의 질의 문자열을 사용한다.

ex. http://www.czarcie.com/abc.cgi?item=1234&color=blue  
제품번호가 1234이고, 파란색의 물품 재고를 검사한다.

### 2.2.7 프래그먼트
URL은 텍스트 문서 전체를 가리키고, 프래그먼트는 리소스 안에 있는 특정 절을 가리킨다.

ex. http://www.czarcie.com/tools.html#drills  

플래그먼트는 서버로 전송하지는 않는다.

## 2.3 단축 URL
### 2.3.1 상대 URL
```html
<a href="./abc.html">
```

상대 URL은 URL을 짧게 표기하는 방식이다. (상대 경로를 말한다.)

### 2.3.2 URL 확장
자동 입력을 말한다.

#### 호스트 명 확장
예를 들어 'naver'를 입력하면, 브라우저는 호스트 명에 자동으로 'www'와 '.com'을 붙여서 'www.naver.com'을 만든다.  
이 기능은 사용자의 시간을 절약해주지만, 호스트 명에 대한 확장 기능은 프락시와 같은 다른 HTTP 애플리케이션에서 문제가 될 수도 있다.(chap 6에서 자세히 다룸)
#### 히스토리 확장
사용자가 과거에 방문했던 URL의 기록을 저장해서, 사용자가 타이핑하는 URL을 예상해서 알려준다.
![]({{ site.url }}/img/post/http/2.3.2.png)

## 2.4 안전하지 않은 문자
안전한 전송이란, 정보가 유실될 위험 없이 URL을 전송할 수 있다는 것을 의미한다.

### 2.4.1 URL 문자 집합
역사적으로 많은 컴퓨터 애플리케이션은 US-ASCII 문자 집합을 사용했다. 7비트를 사용하여 영문 자판과 몇몇 제어 문자만 포함한다.
하지만 영어 이외의 문자는 지원하지 않고, 이진 데이터를 포함해야 하는 경우도 있어서, URL 설계자들은 URL에 이스케이프 문자열을 쓸 수 있게 설계하였다. 이스케이프 문자열은 특정 문자나 데이터를 인코딩할 수 있게 함으로써 이동성과 완성도를 높였다.

### 2.4.2 인코딩 체계
표현의 한계를 넘기 위해, URL에 있는 안전하지 않은 문자들을 표현할 수 있는 인코딩 방식이 고안되었다. 인코딩은 안전하지 않은 문자를 퍼센티지(%)로 시작해, ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 '이스케이프' 문자로 바꾼다.

문자 | ASCII 코드 | URL 예
---|---|---
`~` | 126(0x7E) | http://www.czarcie.com/%7Ejoe
빈 문자 | 32(0x20) | http://www.czarcie.com/more%20tools.html
`%` | 37(0x25) | http://www.czarcie.com/100%25status.html

### 2.4.3 문자 제한
몇몇 문자는 URL 내에서 특별한 의미로 예약되어 있다.

문자 | 선점 및 제한
---|---
% | 인코딩된 문자에 사용할 이스케이프 토큰으로 선점
/ | 경로 컴포넌트에 있는 경로 세그먼트를 나누는 용도로 선점
. | 경로 컴포넌트에서 선점
.. | 경로 컴포넌트에서 선점
# | 프래그먼트의 구획 문자로 선점
? | 질의 문자열의 구획 문자로 선점
; | 파라미터의 구획 문자로 선점
: | 스킴, 사용자 이름/비밀번호, 호스트/포트의 구획 문자로 선점
$, + | 선점
@ & = | 특정 스킴에서 특별한 의미가 있기 때문에 선점
{ } \| \ ^ ~ [ ] | 게이트웨이와 같은 여러 전송 에이전트에서 불안전하게 다루기 때문에 제한됨
< > " | 안전하지 않음. URL 범위 밖에서 역할이 있는 문자이기 떄문에 반드시 인코딩해야 한다.
0x00-0x1F, 0x7F | 제한됨. 이 16진수 범위에 속하는 문자들은 인쇄되지 않는 US-ASCII 문자다.
> 0x7F | 제한됨. 이 16진수 범위에 속하는 문자들은 7비트 US-ASCII 문자가 아니다.

### 2.4.4 좀 더 알아보기
입력받은 URL에서 어떤 문자를 인코딩해야 하는지 결정하는 데는 브라우저와 같이 사용자로부터 최초로 URL을 입력받는 애플리케이션에서 하는 것이 가장 적절하다.

## 2.5 스킴의 바다
유명한 스킴들을 요약한 표이다.

스킴 | 설명
---|---
http | HTTP 스킴이다. 포트 기본값은 80이다. <br> 기본형식: `http://<호스트>:<포트>/<경로>?<질의>#<플래그먼트>`
https | SSL을 사용하는 HTTP. 기본 포트값은 443이다. <br> 기본형식: `http://<호스트>:<포트>/<경로>?<질의>#<플래그먼트>`
mailto | 이메일 주소를 가리킨다. 다른 스킴과 다르게 동작하기 때문에, 표준 URL과는 다른 포맷을 가진다. <br> 기본형식: `mailto:<메일주소>`
ftp | FTP <br> 기본형식: `ftp://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>`
rtsp, rtspu | 실시간 스트리밍. 'u'는 리소스를 읽기 위해서 UDP 프로토콜이 사용됨을 뜻한다. <br> 기본형식 <br> `rtsp://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>` <br> `rtspu://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>`
file | 주어진 호스트 기기에서 바로 접근할 수 있는 파일들을 나타낸다. <br> 기본형식: `file://<호스트>/<경로>`
news | 특정 문서나 뉴스 그룹에 접근하는데 사용한다. news URL은 리소스의 위치 정보를 충분히 포함하지 않는 특이한 속성이 있다. <br> 기본형식 <br> `news:<newsgroup>` <br> `news:<news-article-id>`
telnet | 대화형 애플리케이션. <br> 기본형식: `telnet://<사용자 이름>:<비밀번호>@<호스트>:<포트>/`

## 2.6 미래
URL은 리소스가 옮겨지면 URL을 더는 사용할 수 없다는 단점이 있다.  

이런 문제를 예방할 수 있는 방법은, 객체의 위치와 상관없이, 그 객체를 가리키는 실제 객체의 이름을 사용하는 것이다. 사람처럼 리소스의 이름과 다른 몇 가지 정보만 있으면 그것의 위치가 바뀌더라도 리소스의 위치를 찾을 수 있다. 이를 위해 URN(Uniform Resource Names)라는 새로운 표준 작업이 진행중이다.  

지속 통합 자원 지시자(Persistent Uniform Resource Locators, PURL)를 사용하면 URL로 URN의 기능을 제공할 수 있다. PURL은 리소스의 실제 URL 목록을 관리하고 추적하는 리소스 위치 중개 서버를 두고, 해당 리소스를 우회적으로 제공한다.  

클라이언트는 위치 할당자에게 리소스를 가져올 수 있는 영구적인 URL을 요청할 수 있다.

### 2.6.1 지금이 아니면, 언제?
URL에서 URN으로 주소 체계를 바꾸는 것은 매우 큰 작업이라 시간이 오래 걸린다. URL은 나름의 한계가 있지만, 긴급한 사안은 아니다. URL은 대체할 수 있는 작명 스킴이 나오기 전까지는 계속 사용될 것이다.
